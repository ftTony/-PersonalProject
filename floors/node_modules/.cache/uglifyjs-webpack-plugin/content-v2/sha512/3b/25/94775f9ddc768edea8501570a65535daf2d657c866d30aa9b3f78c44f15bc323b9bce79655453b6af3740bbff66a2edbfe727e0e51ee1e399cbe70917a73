{"map":"{\"version\":3,\"sources\":[\"/Users/tony/Documents/notes/floors/app/js/game_controller.js\"],\"names\":[\"__webpack_require__\",\"window\",\"requestAnimationFrame\",\"webkitRequestAnimationFrame\",\"mozRequestAnimationFrame\",\"cb\",\"GameController\",\"this\",\"floorRate\",\"name\",\"rate\",\"fps\",\"speed\",\"maxSpeed\",\"peopleVerticalSpeed\",\"animation\",\"canvasWidth\",\"canvasHeight\",\"floorWidth\",\"floorHeight\",\"floorDeltaY\",\"floorScore\",\"blood\",\"$container\",\"$\",\"$canvas\",\"$scroller\",\"$people\",\"peopleRotateZ\",\"peopleRotateDelta\",\"peopleHeight\",\"peopleWidth\",\"_t\",\"_currentScrollerY\",\"_currentPeopleY\",\"_currentPeopleVertical\",\"_floorScrollerY\",\"_maxJumpDistance\",\"_frameIndex\",\"_v0\",\"checkFloorConfig\",\"prototype\",\"constructor\",\"Event\",\"on\",\"event\",\"fn\",\"indexOf\",\"gameover\",\"stop\",\"setTimeout\",\"hide\",\"show\",\"bind\",\"rangeArray\",\"totalRate\",\"config\",\"i\",\"length\",\"_rate\",\"TypeError\",\"push\",\"RangeError\",\"_floorRateArray\",\"getRandowFloor\",\"dice\",\"Math\",\"random\",\"createFloorSpan\",\"_top\",\"_left\",\"floorElement\",\"css\",\"top\",\"left\",\"width\",\"height\",\"appendTo\",\"removeFloorSapn\",\"eq\",\"remove\",\"updateScore\",\"updateBlood\",\"$bloodEle\",\"removeClass\",\"addClass\",\"trigger\",\"text\",\"loseBlood\",\"__onFloor\",\"addBlood\",\"floorNormal\",\"floorNail\",\"floorWeak\",\"$floorEle\",\"cross\",\"floorScroll\",\"direction\",\"__floorScrollDirection\",\"floorScrollEnd\",\"floorSpring\",\"__$currentJumpFloor\",\"jumpStart\",\"__jumpMode\",\"jumpEnd\",\"hitTop\",\"_currentJumpDistance\",\"people\",\"dt\",\"_deltaPeopleY\",\"gravity\",\"_deltaY\",\"_deltaPeopleVertical\",\"$floor\",\"peopleOffset\",\"offset\",\"floorOffset\",\"distanceGap\",\"abs\",\"hasClass\",\"__temp_deltaPeopleVertical\",\"_peopleGoLeft\",\"_peopleGoRight\",\"peopleUpdateView\",\"floorUpdateView\",\"Modernizr\",\"csstransforms3d\",\"-webkit-transform\",\"-ms-transform\",\"transform\",\"csstransforms\",\"peopleUserController\",\"_this\",\"keydown\",\"e\",\"ev\",\"key\",\"keyup\",\"retrun\",\"core\",\"parseInt\",\"run\",\"_fps\",\"looptime\",\"runAnimation\",\"console\",\"error\",\"clearTimeout\",\"undefined\",\"reRun\",\"extend\",\"__paramBackup\",\"start\",\"backup\",\"floorLoop\"],\"mappings\":\"qGAAAA,EAAA,GAEAC,OAAOC,sBAAwBD,OAAOC,uBAAyBD,OAAOE,6BAA+BF,OAAOG,0BAA4B,SAAUC,GAC9IA,KAGJ,IAAIC,EAAiB,WACjBC,KAAKC,YACGC,KAAM,SACNC,KAAM,KAGND,KAAM,SACNC,KAAM,KAGND,KAAM,OACNC,KAAM,KAGND,KAAM,gBACNC,KAAM,KAGND,KAAM,iBACNC,KAAM,KAGND,KAAM,OACNC,KAAM,KAGdH,KAAKI,IAAM,GACXJ,KAAKK,MAAQ,GACbL,KAAKM,SAAW,IAChBN,KAAKO,oBAAsB,IAC3BP,KAAKQ,UAAY,KACjBR,KAAKS,YAAc,EACnBT,KAAKU,aAAe,EACpBV,KAAKW,WAAa,EAClBX,KAAKY,YAAc,EACnBZ,KAAKa,YAAc,GACnBb,KAAKc,WAAa,EAClBd,KAAKe,MAAQ,GACbf,KAAKgB,WAAaC,EAAE,cACpBjB,KAAKkB,QAAUD,EAAE,gBACjBjB,KAAKmB,UAAYF,EAAE,aACnBjB,KAAKoB,QAAUH,EAAE,WACjBjB,KAAKqB,cAAgB,EACrBrB,KAAKsB,kBAAoB,GACzBtB,KAAKuB,aAAe,EACpBvB,KAAKwB,YAAc,EACnBxB,KAAKyB,GAAK,EACVzB,KAAK0B,kBAAoB,EACzB1B,KAAK2B,gBAAkB,GACvB3B,KAAK4B,uBAAyB,EAC9B5B,KAAK6B,gBAAkB,IACvB7B,KAAK8B,iBAAmB,EACxB9B,KAAK+B,YAAc,EACnB/B,KAAKgC,IAAM,EACXhC,KAAKiC,oBAGTlC,EAAemC,WACXC,YAAapC,EACbqC,OACI,WACA,QACA,QACA,OACA,eAEJC,GAAI,SAAUC,EAAOC,IACkB,IAA/BvC,KAAKoC,MAAMI,QAAQF,IACvBtC,KAAKgB,WAAWqB,GAAGC,EAAOC,IAK9BE,SAAU,WACNzC,KAAK0C,OACLC,WAAW,WACP1B,EAAE,YAAY2B,OACd3B,EAAE,cAAc4B,QAClBC,KAAK9C,MAAO,MAElBiC,iBAAkB,WAKd,IAJA,IAAIc,GAAc,GACdC,EAAY,EACZC,EAASjD,KAAKC,UAETiD,EAAI,EAAGA,EAAID,EAAOE,OAAQD,IAAK,CACpC,IAAIE,EAAQH,EAAOC,GAAG/C,KACtB,GAAqB,iBAAViD,EACP,MAAM,IAAIC,UAAU,mBAExBL,GAAaI,EACbL,EAAWO,KAAKN,GAEpB,GAAkB,MAAdA,EACA,MAAM,IAAIO,WAAW,oBAEzBvD,KAAKwD,gBAAkBT,GAE3BU,eAAgB,SAAUV,GAEtB,IADA,IAAIW,EAAuB,IAAhBC,KAAKC,SACPV,EAAI,EAAGA,EAAIH,EAAWI,OAAS,EAAGD,IACvC,GAAIQ,GAAQX,EAAWG,IAAMQ,EAAOX,EAAWG,EAAI,GAC/C,OAAOlD,KAAKC,UAAUiD,IAOlCW,gBAAiB,WACb,IAAIC,EAAO9D,KAAK6B,iBAAmB7B,KAAKa,YACpCkD,EAAQJ,KAAKC,UAAY5D,KAAKS,YAAcT,KAAKW,YAEjDqD,EAAe,mBADDhE,KAAKyD,eAAezD,KAAKwD,iBACStD,KAAO,SAE3De,EAAE+C,GAAcC,KACZC,IAAKJ,EACLK,KAAMJ,EACNK,MAAOpE,KAAKW,WACZ0D,OAAQrE,KAAKY,cACd0D,SAAStE,KAAKmB,YAKrBoD,gBAAiB,WACbtD,EAAE,UAAUuD,GAAG,GAAGC,SAClBzE,KAAKc,aACLd,KAAK0E,eAKTC,YAAa,WAET,IADA,IAAIC,EAAY3D,EAAE,YACTiC,EAAI,EAAGA,EAAI0B,EAAUzB,OAAQD,IAC9BA,EAAIlD,KAAKe,MACT6D,EAAUJ,GAAGtB,GAAG2B,YAAY,QAE5BD,EAAUJ,GAAGtB,GAAG4B,SAAS,SAOrCJ,YAAa,WACT1E,KAAKgB,WAAW+D,QAAQ,eACxB9D,EAAE,eAAe+D,KAAKhF,KAAKc,aAK/BmE,UAAW,WACP,IAAIjF,KAAKkF,UAAT,CAcA,GAbAlF,KAAKe,OAAS,EAEdf,KAAKoB,QAAQ0D,SAAS,UACtBnC,WAAW,WACP3C,KAAKoB,QAAQyD,YAAY,WAC3B/B,KAAK9C,MAAO,KAGdiB,EAAE,YAAY6D,SAAS,UACvBnC,WAAW,WACP1B,EAAE,YAAY4D,YAAY,WAC3B,KAEC7E,KAAKe,OAAS,EAId,OAHAf,KAAKe,MAAQ,EACbf,KAAK2E,mBACL3E,KAAKyC,WAGTzC,KAAK2E,gBAETQ,SAAU,WAEFnF,KAAKkF,WAAalF,KAAKe,OAAS,KACpCf,KAAKe,OAAS,EACdf,KAAK2E,gBAETS,YAAa,WACTpF,KAAKmF,YAETE,UAAW,WACPrF,KAAKiF,aAETK,UAAW,SAAUC,GACjBvF,KAAKmF,WACLxC,WAAW,WACP4C,EAAUT,SAAS,QACnBS,EAAU,GAAGC,OAAQ,GACtB,MAEPC,YAAa,SAAUC,GACnB1F,KAAKmF,WACLnF,KAAK2F,uBAAyBD,GAElCE,eAAgB,WACZ5F,KAAK2F,uBAAyB,MAElCE,YAAa,WACT7F,KAAK8F,oBAAsBP,UAC3BvF,KAAK+F,YACL/F,KAAKmF,YAETY,UAAW,WACP/F,KAAKgG,YAAa,EAClBhG,KAAK8F,oBAAoBhB,SAAS,MAClCnC,WAAW,WACP3C,KAAK8F,oBAAoBjB,YAAY,OACvC/B,KAAK9C,MAAO,MAElBiG,QAAS,SAAUC,GACVlG,KAAKgG,aAGNE,IACAlG,KAAK8F,oBAAoB,GAAGN,OAAQ,GAGxCxF,KAAKmG,qBAAuB,EAE5BnG,KAAKgG,YAAa,IAEtBI,OAAQ,SAAUhG,GAEd,IAAIiG,EAAK,EAAIjG,EAETkG,EAAgBtG,KAAKgC,IAAMqE,EAAKrG,KAAKuG,QAAWF,EAAOA,EAAM,EAEjErG,KAAKyB,IAAM4E,EAEXrG,KAAKgC,IAAMhC,KAAKuG,QAAUvG,KAAKyB,GAE/B,IAAI+E,EAAUxG,KAAKK,MAAQD,EAEvBqG,EAAuBzG,KAAKO,oBAAsBH,EAElDsG,EAASzF,EAAE,UAEX0F,EAAe3G,KAAKoB,QAAQwF,SAGhC,GAAID,EAAazC,IAAMlE,KAAKU,aACxBV,KAAKyC,eADT,CAKA,IAAK,IAAIS,EAAI,EAAGA,EAAIwD,EAAOvD,OAAQD,IAAK,CAEpC,IAAI2D,EAAcH,EAAOlC,GAAGtB,GAAG0D,SAE3BE,EAAcnD,KAAKoD,IAAIJ,EAAazC,IAAMlE,KAAKuB,aAAesF,EAAY3C,KAE9E,GAAIyC,EAAazC,KAAOoC,EAAgBE,EAAS,CAC7CxG,KAAKyB,GAAK,EACVzB,KAAKkF,WAAY,EACjBlF,KAAKiG,SAAQ,GACbjG,KAAKiF,YACL,MAGJ,IAAKjF,KAAKgG,aAELU,EAAOlC,GAAGtB,GAAG,GAAGsC,OAEjBsB,GAAeR,EAAgBE,GAE/BG,EAAaxC,KAAO0C,EAAY1C,KAAOnE,KAAKwB,aAE5CmF,EAAaxC,KAAO0C,EAAY1C,KAAOnE,KAAKW,WAAY,CAExDX,KAAK2B,gBAAkBkF,EAAY3C,IAAMlE,KAAKuB,aAE1CmF,EAAOlC,GAAGtB,GAAG8D,SAAS,WACtBhH,KAAKoF,cAELsB,EAAOlC,GAAGtB,GAAG8D,SAAS,SACtBhH,KAAKqF,YAELqB,EAAOlC,GAAGtB,GAAG8D,SAAS,WACtBhH,KAAK6F,YAAYa,EAAOlC,GAAGtB,IAE3BwD,EAAOlC,GAAGtB,GAAG8D,SAAS,SACtBhH,KAAKsF,UAAUoB,EAAOlC,GAAGtB,IAEzBwD,EAAOlC,GAAGtB,GAAG8D,SAAS,gBACtBhH,KAAKyF,YAAY,QAEjBiB,EAAOlC,GAAGtB,GAAG8D,SAAS,iBACtBhH,KAAKyF,YAAY,SAErBzF,KAAKyB,GAAK,EACVzB,KAAKkF,WAAY,EACjB,MAGAhC,IAAMwD,EAAOvD,OAAS,IACtBnD,KAAKkF,WAAY,GAKrBlF,KAAKgG,aACDhG,KAAKmG,sBAAwBnG,KAAK8B,iBAClC9B,KAAKiG,WAELjG,KAAKmG,sBAAwBG,EAE7BtG,KAAK2B,iBAAmB2E,EAAgBE,IAK3CxG,KAAKkF,WAAclF,KAAKgG,aACzBhG,KAAK4F,iBACL5F,KAAK2B,iBAAmB2E,GAI5B,IAAIW,EAA6BR,EAE7BzG,KAAKkH,gBAC+B,SAAhClH,KAAK2F,yBACLsB,GAA8B,KAEE,UAAhCjH,KAAK2F,yBACLsB,GAA8B,KAE9BjH,KAAK4B,uBAAyB,IAC9B5B,KAAK4B,wBAA0BqF,IAInCjH,KAAKmH,iBAC+B,SAAhCnH,KAAK2F,yBACLsB,GAA8B,IAEE,UAAhCjH,KAAK2F,yBACLsB,GAA8B,IAE9BjH,KAAK4B,uBAAyB5B,KAAKS,YAAcT,KAAKwB,cACtDxB,KAAK4B,wBAA0BqF,IAIlCjH,KAAKmH,gBAAmBnH,KAAKkH,gBAC9BD,GAA8B,GACM,SAAhCjH,KAAK2F,wBACD3F,KAAK4B,uBAAyB,IAC9B5B,KAAK4B,wBAA0BqF,GAGH,UAAhCjH,KAAK2F,wBACD3F,KAAK4B,uBAAyB5B,KAAKS,YAAcT,KAAKwB,cACtDxB,KAAK4B,wBAA0BqF,IAK3CjH,KAAKoH,qBAGTC,gBAAiB,WACTC,UAAUC,gBACVvH,KAAKmB,UAAU8C,KACXuD,oBAAqB,iBAAmBxH,KAAK0B,kBAAoB,MACjE+F,gBAAiB,iBAAmBzH,KAAK0B,kBAAoB,MAC7DgG,UAAa,iBAAmB1H,KAAK0B,kBAAoB,QAEtD4F,UAAUK,cACjB3H,KAAKmB,UAAU8C,KACXuD,oBAAqB,cAAgBxH,KAAK0B,kBAAoB,IAC9D+F,gBAAiB,cAAgBzH,KAAK0B,kBAAoB,IAC1DgG,UAAa,cAAgB1H,KAAK0B,kBAAoB,MAG1D1B,KAAKmB,UAAU8C,KACXC,IAAOlE,KAAK0B,kBAAoB,QAI5C0F,iBAAkB,WACVpH,KAAKkF,YACDlF,KAAKkH,gBACLlH,KAAKqB,eAAiBrB,KAAKsB,mBAE3BtB,KAAKmH,iBACLnH,KAAKqB,eAAiBrB,KAAKsB,oBAG/BgG,UAAUC,gBACVvH,KAAKoB,QAAQ6C,KACTuD,oBAAqB,eAAiBxH,KAAK4B,uBAAyB,MAAQ5B,KAAK2B,gBAAkB,QACnG8F,gBAAiB,eAAiBzH,KAAK4B,uBAAyB,MAAQ5B,KAAK2B,gBAAkB,QAC/F+F,UAAa,eAAiB1H,KAAK4B,uBAAyB,MAAQ5B,KAAK2B,gBAAkB,UAExF2F,UAAUK,cACjB3H,KAAKoB,QAAQ6C,KACTuD,oBAAqB,aAAexH,KAAK4B,uBAAyB,MAAQ5B,KAAK2B,gBAAkB,QACjG8F,gBAAiB,aAAezH,KAAK4B,uBAAyB,MAAQ5B,KAAK2B,gBAAkB,QAC7F+F,UAAa,aAAe1H,KAAK4B,uBAAyB,MAAQ5B,KAAK2B,gBAAkB,UAG7F3B,KAAKoB,QAAQ6C,KACTE,KAAQnE,KAAK4B,uBAAyB,KACtCsC,IAAOlE,KAAK2B,gBAAkB,QAI1CiG,qBAAsB,WAClB,IAAIC,EAAQ7H,KACZiB,EAAEvB,QAAQoI,QAAQ,SAAUC,GACxB,GAAe,eAAXC,GAAGC,IAGH,OAFAJ,EAAMV,gBAAiB,OACvBU,EAAMX,eAAgB,GAGX,cAAXc,GAAGC,MACHJ,EAAMV,gBAAiB,EACvBU,EAAMX,eAAgB,KAE3BgB,MAAM,SAAUF,GACA,eAAXA,EAAGC,MACHJ,EAAMV,gBAAiB,EACvBgB,QAEW,cAAXH,EAAGC,MACHJ,EAAMX,eAAgB,KAK9BjG,EAAE,wBAAwBoB,GAAG,aAAc,SAAU2F,GACjDH,EAAMV,gBAAiB,EACvBU,EAAMX,eAAgB,IACvB7E,GAAG,YAAa,SAAU2F,GACzBH,EAAMX,eAAgB,IAG1BjG,EAAE,yBAAyBoB,GAAG,aAAc,SAAU2F,GAClDH,EAAMV,gBAAiB,EACvBU,EAAMX,eAAgB,IACvB7E,GAAG,WAAY,SAAU2F,GACxBH,EAAMV,gBAAiB,KAG/BiB,KAAM,SAAUhI,GACZ,IACIoG,EAAUxG,KAAKK,MAAQD,EACvBsG,EAASzF,EAAE,UAMf,GAHAjB,KAAK0B,mBAAqB8E,EAGtBxG,KAAK0B,mBAA0C,GAApB1B,KAAKU,aAAkB,CAElDV,KAAK0B,mBAAqB1B,KAAKU,aAE/BV,KAAK6B,iBAAmB7B,KAAKU,aAE7B,IAAK,IAAIwC,EAAI,EAAGA,EAAIwD,EAAOvD,OAAQD,IAC/BwD,EAAOlC,GAAGtB,GAAGe,KACTC,IAAKmE,SAASpH,EAAE,UAAUuD,GAAGtB,GAAGe,IAAI,QAAUjE,KAAKU,eAK/DV,KAAKqH,kBAGDX,EAAOlC,GAAG,GAAGoC,SAAS1C,MAAQ,KAC9BlE,KAAK6D,kBACL7D,KAAKuE,mBAITvE,KAAKoG,OAAOhG,GAERJ,KAAKK,OAASL,KAAKM,WACnBN,KAAKK,OAAS,KAGtBiI,IAAK,SAAUlI,GACX,IAAIJ,KAAKQ,UAAT,CAKAR,KAAKuI,KAAOnI,EAAMA,GAAO,GACzB,IAAIoI,EAAW,IAAOpI,EAClByH,EAAQ7H,KAUZ,OAAOA,KAAKQ,UAPDmC,WAAW,WACdjD,OAAOC,sBAAsB,WACzBkI,EAAMO,KAAKhI,KAEfyH,EAAMY,gBACPD,GAdHE,QAAQC,MAAM,6DAkBtBjG,KAAM,WACFkG,aAAa5I,KAAKQ,WAClBR,KAAKQ,eAAYqI,EACjB7I,KAAKgB,WAAW+D,QAAQ,SAE5B+D,MAAO,WACH9I,KAAKgB,WAAW+D,QAAQ,SAExB9D,EAAE8H,OAAO/I,KAAMA,KAAKgJ,eAEpB/H,EAAE,UAAUwD,SAEZzE,KAAKiJ,SAETC,OAAQ,WAGJ,IAAK,IAAIhG,KADTlD,KAAKgJ,iBACShJ,KACa,iBAAZA,KAAKkD,IAAsC,iBAAZlD,KAAKkD,KAC3ClD,KAAKgJ,cAAc9F,GAAKlD,KAAKkD,KAIzC+F,MAAO,WACH,IACIE,EAAY,EAahB,IAZAnJ,KAAKgB,WAAW+D,QAAQ,SACxB/E,KAAKS,YAAcT,KAAKkB,QAAQkD,QAChCpE,KAAKU,aAAeV,KAAKkB,QAAQmD,SACjCrE,KAAKa,YAAcb,KAAKU,aAAe,GACvCV,KAAKW,WAAaX,KAAKS,YAAc,EACrCT,KAAKY,YAAcZ,KAAKW,WAAa,EACrCX,KAAKuB,aAAe8G,SAASrI,KAAKoB,QAAQ6C,IAAI,WAC9CjE,KAAKwB,YAAc6G,SAASrI,KAAKoB,QAAQ6C,IAAI,UAE7CjE,KAAK4B,uBAAyB5B,KAAKS,YAAc,EAAIT,KAAKwB,YAAc,EACxExB,KAAKkJ,SAEEC,IAAc,IACjBnJ,KAAK6D,kBAGT7D,KAAK4H,uBAEL5H,KAAKoH,mBAELpH,KAAK2E,cAEL3E,KAAK0E,cAEL1E,KAAKsI,IAAItI,KAAKI,iBAIPL\",\"sourcesContent\":[\"import './zepto-touch';\\n\\nwindow.requestAnimationFrame = window.requestAnimationFrame || window.webkitRequestAnimationFrame || window.mozRequestAnimationFrame || function (cb) {\\n    cb();\\n}\\n\\nvar GameController = function () {\\n    this.floorRate = [{\\n            name: 'normal',\\n            rate: 15,\\n        },\\n        {\\n            name: 'spring',\\n            rate: 15\\n        },\\n        {\\n            name: 'weak',\\n            rate: 15\\n        },\\n        {\\n            name: 'scroller-left',\\n            rate: 10\\n        },\\n        {\\n            name: 'scroller-right',\\n            rate: 10\\n        },\\n        {\\n            name: 'nail',\\n            rate: 35\\n        },\\n    ];\\n    this.fps = 60; //刷新频率\\n    this.speed = 50; //卷轴初始速度\\n    this.maxSpeed = 350; //卷轴最大速度\\n    this.peopleVerticalSpeed = 200; //人物横向移动速度\\n    this.animation = null;\\n    this.canvasWidth = 0; //画布宽度\\n    this.canvasHeight = 0; //画面高度\\n    this.floorWidth = 0; //楼层宽度\\n    this.floorHeight = 0; //楼层高度\\n    this.floorDeltaY = 50;\\n    this.floorScore = 1;\\n    this.blood = 12; //人物血量\\n    this.$container = $('.container');\\n    this.$canvas = $('.game-canvas');\\n    this.$scroller = $('.scroller');\\n    this.$people = $('.people');\\n    this.peopleRotateZ = 0;\\n    this.peopleRotateDelta = 25; //小球滚动角度\\n    this.peopleHeight = 0;\\n    this.peopleWidth = 0;\\n    this._t = 0;\\n    this._currentScrollerY = 0;\\n    this._currentPeopleY = 20;\\n    this._currentPeopleVertical = 0;\\n    this._floorScrollerY = 200;\\n    this._maxJumpDistance = 0;\\n    this._frameIndex = 0;\\n    this._v0 = 0;\\n    this.checkFloorConfig();\\n};\\n\\nGameController.prototype = {\\n    constructor: GameController,\\n    Event: [\\n        'gameover',\\n        'start',\\n        'rerun',\\n        'stop',\\n        'scoreupdate'\\n    ],\\n    on: function (event, fn) {\\n        if (this.Event.indexOf(event) === -1) return;\\n        this.$container.on(event, fn);\\n    },\\n    /**\\n     * 游戏结束\\n     */\\n    gameover: function () {\\n        this.stop();\\n        setTimeout(function () {\\n            $('#game-ct').hide();\\n            $('.game-over').show();\\n        }.bind(this), 200);\\n    },\\n    checkFloorConfig: function () {\\n        var rangeArray = [0];\\n        var totalRate = 0;\\n        var config = this.floorRate;\\n\\n        for (var i = 0; i < config.length; i++) {\\n            var _rate = config[i].rate;\\n            if (typeof _rate !== 'number') {\\n                throw new TypeError('rate type error');\\n            }\\n            totalRate += _rate;\\n            rangeArray.push(totalRate);\\n        }\\n        if (totalRate !== 100) {\\n            throw new RangeError('rate 加起来务必等于100!');\\n        }\\n        this._floorRateArray = rangeArray;\\n    },\\n    getRandowFloor: function (rangeArray) {\\n        var dice = Math.random() * 100;\\n        for (var i = 0; i < rangeArray.length - 1; i++) {\\n            if (dice >= rangeArray[i] && dice < rangeArray[i + 1]) {\\n                return this.floorRate[i];\\n            }\\n        }\\n    },\\n    /**\\n     * 创建楼层\\n     */\\n    createFloorSpan: function () {\\n        var _top = this._floorScrollerY += this.floorDeltaY,\\n            _left = Math.random() * (this.canvasWidth - this.floorWidth);\\n        var floorConfig = this.getRandowFloor(this._floorRateArray);\\n        var floorElement = '<i class=\\\"floor ' + floorConfig.name + '\\\"></i>';\\n\\n        $(floorElement).css({\\n            top: _top,\\n            left: _left,\\n            width: this.floorWidth,\\n            height: this.floorHeight\\n        }).appendTo(this.$scroller);\\n    },\\n    /**\\n     * 移除楼层\\n     */\\n    removeFloorSapn: function () {\\n        $('.floor').eq(0).remove();\\n        this.floorScore++;\\n        this.updateScore();\\n    },\\n    /**\\n     * 更改血\\n     */\\n    updateBlood: function () {\\n        var $bloodEle = $('.blood i');\\n        for (var i = 0; i < $bloodEle.length; i++) {\\n            if (i < this.blood) {\\n                $bloodEle.eq(i).removeClass('lose');\\n            } else {\\n                $bloodEle.eq(i).addClass('lose');\\n            }\\n        }\\n    },\\n    /**\\n     * 修改分数\\n     */\\n    updateScore: function () {\\n        this.$container.trigger('scoreupdate');\\n        $('.text-score').text(this.floorScore);\\n    },\\n    /**\\n     * 失分数\\n     */\\n    loseBlood: function () {\\n        if (this.__onFloor) return;\\n        this.blood -= 0;\\n        //人变红\\n        this.$people.addClass('danger');\\n        setTimeout(function () {\\n            this.$people.removeClass('danger');\\n        }.bind(this), 1000);\\n\\n        //背影闪烁\\n        $('#game-ct').addClass('danger');\\n        setTimeout(() => {\\n            $('#game-ct').removeClass('danger');\\n        }, 100);\\n\\n        if (this.blood <= 0) {\\n            this.blood = 0;\\n            this.updateBlood();\\n            this.gameover();\\n            return;\\n        }\\n        this.updateBlood();\\n    },\\n    addBlood: function () {\\n        //当人物在平台上时，或者血量大于12，不重复加血\\n        if (this.__onFloor || this.blood >= 12) return;\\n        this.blood += 1;\\n        this.updateBlood();\\n    },\\n    floorNormal: function () {\\n        this.addBlood();\\n    },\\n    floorNail: function () {\\n        this.loseBlood();\\n    },\\n    floorWeak: function ($floorEle) {\\n        this.addBlood();\\n        setTimeout(function () {\\n            $floorEle.addClass('over');\\n            $floorEle[0].cross = true;\\n        }, 200);\\n    },\\n    floorScroll: function (direction) {\\n        this.addBlood();\\n        this.__floorScrollDirection = direction;\\n    },\\n    floorScrollEnd: function () {\\n        this.__floorScrollDirection = null;\\n    },\\n    floorSpring: function () {\\n        this.__$currentJumpFloor = $floorEle;\\n        this.jumpStart();\\n        this.addBlood();\\n    },\\n    jumpStart: function () {\\n        this.__jumpMode = true;\\n        this.__$currentJumpFloor.addClass('up');\\n        setTimeout(function () {\\n            this.__$currentJumpFloor.removeClass('up');\\n        }.bind(this), 200);\\n    },\\n    jumpEnd: function (hitTop) {\\n        if (!this.__jumpMode) {\\n            return;\\n        }\\n        if (hitTop) {\\n            this.__$currentJumpFloor[0].cross = true;\\n        }\\n        //重置跳跃高度\\n        this._currentJumpDistance = 0;\\n        //解除跳跃\\n        this.__jumpMode = false;\\n    },\\n    people: function (fps) {\\n        //每帧消耗时间 ms\\n        var dt = 1 / fps;\\n        //人物纵向每帧移动距离 \\n        var _deltaPeopleY = this._v0 * dt + this.gravity * (dt) * (dt) / 2;\\n        //更新时间 t=t+dt;\\n        this._t += dt;\\n        // 更新速度 v=at\\n        this._v0 = this.gravity * this._t;\\n        //卷轴纵向每帧移动距离\\n        var _deltaY = this.speed / fps;\\n        //人物横向每帧移动距离\\n        var _deltaPeopleVertical = this.peopleVerticalSpeed / fps;\\n        // 缓存floor\\n        var $floor = $('.floor');\\n        //缓存offset\\n        var peopleOffset = this.$people.offset();\\n\\n        //人物掉落屏幕下方，游戏结束\\n        if (peopleOffset.top > this.canvasHeight) {\\n            this.gameover();\\n            return;\\n        }\\n        // 碰撞检测\\n        for (var i = 0; i < $floor.length; i++) {\\n            //缓存offset\\n            var floorOffset = $floor.eq(i).offset();\\n            //人物与楼梯纵向距离\\n            var distanceGap = Math.abs(peopleOffset.top + this.peopleHeight - floorOffset.top);\\n            // 当人物撞到顶部，掉血+掉落+打断跳跃\\n            if (peopleOffset.top <= _deltaPeopleY + _deltaY) {\\n                this._t = 0;\\n                this.__onFloor = false;\\n                this.jumpEnd(true);\\n                this.loseBlood();\\n                break;\\n            }\\n            // 跳跃模式不进入检测\\n            if (!this.__jumpMode &&\\n                //元素不可直接穿过\\n                !$floor.eq(i)[0].cross &&\\n                // 人物与楼梯纵向距离在一帧移动距离之内\\n                distanceGap <= _deltaPeopleY + _deltaY &&\\n                // 人物横向距离不超过楼梯最左\\n                peopleOffset.left > floorOffset.left - this.peopleWidth &&\\n                //人物横向距离不走过楼梯最右\\n                peopleOffset.left < floorOffset.left + this.floorWidth) {\\n                // 人物与楼梯偏差修正\\n                this._currentPeopleY = floorOffset.top - this.peopleHeight;\\n                // 施加各类楼梯特殊属性\\n                if ($floor.eq(i).hasClass('normal')) {\\n                    this.floorNormal();\\n                }\\n                if ($floor.eq(i).hasClass('nail')) {\\n                    this.floorNail();\\n                }\\n                if ($floor.eq(i).hasClass('spring')) {\\n                    this.floorSpring($floor.eq(i));\\n                }\\n                if ($floor.eq(i).hasClass('weak')) {\\n                    this.floorWeak($floor.eq(i));\\n                }\\n                if ($floor.eq(i).hasClass('scroll-left')) {\\n                    this.floorScroll('left');\\n                }\\n                if ($floor.eq(i).hasClass('scroll-right')) {\\n                    this.floorScroll('right');\\n                }\\n                this._t = 0;\\n                this.__onFloor = true;\\n                break;\\n            }\\n            //当循环执行完毕，仍然没有发现碰撞，则表明人物不在平台上\\n            if (i === $floor.length - 1) {\\n                this.__onFloor = false;\\n            }\\n        }\\n\\n        //人物向上跳起\\n        if (this.__jumpMode) {\\n            if (this._currentJumpDistance >= this._maxJumpDistance) {\\n                this.jumpEnd();\\n            } else {\\n                this._currentJumpDistance += _deltaPeopleY;\\n                // 向上跳起效果要额外加上_deltaY，以匹配卷轴运动状态\\n                this._currentPeopleY -= _deltaPeopleY + _deltaY;\\n            }\\n        }\\n\\n        // 人物向下坠落+取消楼梯左右加速状态\\n        if (!this.__onFloor && !this.__jumpMode) {\\n            this.floorScrollEnd();\\n            this._currentPeopleY += _deltaPeopleY;\\n        }\\n\\n        // 横向运动预处理\\n        var __temp_deltaPeopleVertical = _deltaPeopleVertical;\\n        //处理人物向左运动\\n        if (this._peopleGoLeft) {\\n            if (this.__floorScrollDirection === 'left') {\\n                __temp_deltaPeopleVertical *= 1.5;\\n            }\\n            if (this.__floorScrollDirection === 'right') {\\n                __temp_deltaPeopleVertical *= 1.5;\\n            }\\n            if (this._currentPeopleVertical > 0) {\\n                this._currentPeopleVertical -= __temp_deltaPeopleVertical;\\n            }\\n        }\\n        // 处理人物向右运动\\n        if (this._peopleGoRight) {\\n            if (this.__floorScrollDirection === 'left') {\\n                __temp_deltaPeopleVertical *= 0.5;\\n            }\\n            if (this.__floorScrollDirection === 'right') {\\n                __temp_deltaPeopleVertical *= 0.5;\\n            }\\n            if (this._currentPeopleVertical < this.canvasWidth - this.peopleWidth) {\\n                this._currentPeopleVertical += __temp_deltaPeopleVertical;\\n            }\\n        }\\n        // 处理人物在滚动楼梯上的自动运动\\n        if (!this._peopleGoRight && !this._peopleGoLeft) {\\n            __temp_deltaPeopleVertical *= 0.5;\\n            if (this.__floorScrollDirection === 'left') {\\n                if (this._currentPeopleVertical > 0) {\\n                    this._currentPeopleVertical -= __temp_deltaPeopleVertical;\\n                }\\n            }\\n            if (this.__floorScrollDirection === 'right') {\\n                if (this._currentPeopleVertical < this.canvasWidth - this.peopleWidth) {\\n                    this._currentPeopleVertical += __temp_deltaPeopleVertical;\\n                }\\n            }\\n        }\\n        //更新人视图\\n        this.peopleUpdateView();\\n    },\\n    //更新卷轴位置\\n    floorUpdateView: function () {\\n        if (Modernizr.csstransforms3d) {\\n            this.$scroller.css({\\n                '-webkit-transform': 'transform3d(0,' + this._currentScrollerY + ',0)',\\n                '-ms-transform': 'transform3d(0,' + this._currentScrollerY + ',0)',\\n                'transform': 'transform3d(0,' + this._currentScrollerY + ',0)'\\n            });\\n        } else if (Modernizr.csstransforms) {\\n            this.$scroller.css({\\n                '-webkit-transform': 'transformY(' + this._currentScrollerY + ')',\\n                '-ms-transform': 'transformY(' + this._currentScrollerY + ')',\\n                'transform': 'transformY(' + this._currentScrollerY + ')'\\n            });\\n        } else {\\n            this.$scroller.css({\\n                'top': this._currentScrollerY + 'px'\\n            });\\n        }\\n    },\\n    peopleUpdateView: function () {\\n        if (this.__onFloor) {\\n            if (this._peopleGoLeft) {\\n                this.peopleRotateZ -= this.peopleRotateDelta;\\n            }\\n            if (this._peopleGoRight) {\\n                this.peopleRotateZ += this.peopleRotateDelta;\\n            }\\n        }\\n        if (Modernizr.csstransforms3d) {\\n            this.$people.css({\\n                '-webkit-transform': 'transform3d(' + this._currentPeopleVertical + 'px,' + this._currentPeopleY + 'px,0)',\\n                '-ms-transform': 'transform3d(' + this._currentPeopleVertical + 'px,' + this._currentPeopleY + 'px,0)',\\n                'transform': 'transform3d(' + this._currentPeopleVertical + 'px,' + this._currentPeopleY + 'px,0)'\\n            });\\n        } else if (Modernizr.csstransforms) {\\n            this.$people.css({\\n                '-webkit-transform': 'transform(' + this._currentPeopleVertical + 'px,' + this._currentPeopleY + 'px,0)',\\n                '-ms-transform': 'transform(' + this._currentPeopleVertical + 'px,' + this._currentPeopleY + 'px,0)',\\n                'transform': 'transform(' + this._currentPeopleVertical + 'px,' + this._currentPeopleY + 'px,0)'\\n            });\\n        } else {\\n            this.$people.css({\\n                'left': this._currentPeopleVertical + 'px',\\n                'top': this._currentPeopleY + 'px'\\n            })\\n        }\\n    },\\n    peopleUserController: function () {\\n        var _this = this;\\n        $(window).keydown(function (e) {\\n            if (ev.key === 'ArrowRight') {\\n                _this._peopleGoRight = true;\\n                _this._peopleGoLeft = false;\\n                return;\\n            }\\n            if (ev.key === 'ArrowLeft') {\\n                _this._peopleGoRight = false;\\n                _this._peopleGoLeft = true;\\n            }\\n        }).keyup(function (ev) {\\n            if (ev.key === 'ArrowRight') {\\n                _this._peopleGoRight = false;\\n                retrun;\\n            }\\n            if (ev.key === 'ArrowLeft') {\\n                _this._peopleGoLeft = false;\\n                return;\\n            }\\n        });\\n\\n        $('.controller .left-ct').on('touchstart', function (ev) {\\n            _this._peopleGoRight = false;\\n            _this._peopleGoLeft = true;\\n        }).on('tounchend', function (ev) {\\n            _this._peopleGoLeft = false;\\n        });\\n\\n        $('.controller .right-ct').on('touchstart', function (ev) {\\n            _this._peopleGoRight = true;\\n            _this._peopleGoLeft = true;\\n        }).on('touchend', function (ev) {\\n            _this._peopleGoRight = false;\\n        })\\n    },\\n    core: function (fps) {\\n        var _this = this,\\n            _deltaY = this.speed / fps, //卷轴纵向每帧移动距离\\n            $floor = $('.floor');\\n\\n        //计算卷轴位置\\n        this._currentScrollerY -= _deltaY;\\n\\n        //当卷轴超出一定长度之后，进行位置reset，缩减长度，防止Crash现象\\n        if (this._currentScrollerY <= -this.canvasHeight * 2) {\\n            //将卷轴滚动高度减小一屏\\n            this._currentScrollerY += this.canvasHeight;\\n            //将楼梯偏移高度减少一屏\\n            this._floorScrollerY -= this.canvasHeight;\\n            //重置再有楼梯位置\\n            for (var i = 0; i < $floor.length; i++) {\\n                $floor.eq(i).css({\\n                    top: parseInt($('.floor').eq(i).css('top')) - this.canvasHeight\\n                });\\n            }\\n        }\\n        //更新卷轴位置\\n        this.floorUpdateView();\\n\\n        //每个台阶移出视野则清除台阶，并且在底部增加一个新的台阶\\n        if ($floor.eq(0).offset().top <= -20) {\\n            this.createFloorSpan();\\n            this.removeFloorSapn();\\n        }\\n\\n        //调用人物渲染\\n        this.people(fps);\\n        //起来越high\\n        if (this.speed <= this.maxSpeed) {\\n            this.speed += 0.1;\\n        }\\n    },\\n    run: function (fps) {\\n        if (this.animation) {\\n            console.error('Animation has aready in process,please do not run again!');\\n            return;\\n        }\\n\\n        this._fps = fps = fps || 60;\\n        var looptime = 1000 / fps;\\n        var _this = this;\\n\\n        var runAnimation = function () {\\n            return setTimeout(function () {\\n                window.requestAnimationFrame(function () {\\n                    _this.core(fps);\\n                });\\n                _this.runAnimation();\\n            }, looptime);\\n        };\\n        return this.animation = runAnimation();\\n    },\\n    stop: function () {\\n        clearTimeout(this.animation); //暂停动画\\n        this.animation = undefined;\\n        this.$container.trigger('stop');\\n    },\\n    reRun: function () {\\n        this.$container.trigger('rerun');\\n        //重置参数\\n        $.extend(this, this.__paramBackup);\\n        //删除掉再有楼梯\\n        $('.floor').remove();\\n        //重新初始化\\n        this.start();\\n    },\\n    backup: function () {\\n        // 备份寝设置参数，用于游戏reset\\n        this.__paramBackup = {};\\n        for (var i in this) {\\n            if (typeof this[i] === 'number' || typeof this[i] === 'string') {\\n                this.__paramBackup[i] = this[i];\\n            }\\n        }\\n    },\\n    start: function () {\\n        var _this = this,\\n            floorLoop = 0;\\n        this.$container.trigger('start');\\n        this.canvasWidth = this.$canvas.width();\\n        this.canvasHeight = this.$canvas.height();\\n        this.floorDeltaY = this.canvasHeight / 11;\\n        this.floorWidth = this.canvasWidth / 5;\\n        this.floorHeight = this.floorWidth / 9;\\n        this.peopleHeight = parseInt(this.$people.css('height'));\\n        this.peopleWidth = parseInt(this.$people.css('width'));\\n\\n        this._currentPeopleVertical = this.canvasWidth / 2 + this.peopleWidth / 2;\\n        this.backup();\\n        //初始化台阶\\n        while (floorLoop++ < 13) {\\n            this.createFloorSpan();\\n        }\\n        //初始化任务控制\\n        this.peopleUserController();\\n        //首次更新人物视图\\n        this.peopleUpdateView();\\n        //首次更新人物血量\\n        this.updateBlood();\\n        //首次更新楼层数\\n        this.updateScore();\\n        //以每秒60帧执行游戏动画\\n        this.run(this.fps);\\n    }\\n\\n}\\nexport default GameController;\"]}","code":"webpackHotUpdate(0,{10:function(t,e,o){\"use strict\";Object.defineProperty(e,\"__esModule\",{value:!0}),o(9),window.requestAnimationFrame=window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||function(t){t()};var r=function(){this.floorRate=[{name:\"normal\",rate:15},{name:\"spring\",rate:15},{name:\"weak\",rate:15},{name:\"scroller-left\",rate:10},{name:\"scroller-right\",rate:10},{name:\"nail\",rate:35}],this.fps=60,this.speed=50,this.maxSpeed=350,this.peopleVerticalSpeed=200,this.animation=null,this.canvasWidth=0,this.canvasHeight=0,this.floorWidth=0,this.floorHeight=0,this.floorDeltaY=50,this.floorScore=1,this.blood=12,this.$container=$(\".container\"),this.$canvas=$(\".game-canvas\"),this.$scroller=$(\".scroller\"),this.$people=$(\".people\"),this.peopleRotateZ=0,this.peopleRotateDelta=25,this.peopleHeight=0,this.peopleWidth=0,this._t=0,this._currentScrollerY=0,this._currentPeopleY=20,this._currentPeopleVertical=0,this._floorScrollerY=200,this._maxJumpDistance=0,this._frameIndex=0,this._v0=0,this.checkFloorConfig()};r.prototype={constructor:r,Event:[\"gameover\",\"start\",\"rerun\",\"stop\",\"scoreupdate\"],on:function(t,e){-1!==this.Event.indexOf(t)&&this.$container.on(t,e)},gameover:function(){this.stop(),setTimeout(function(){$(\"#game-ct\").hide(),$(\".game-over\").show()}.bind(this),200)},checkFloorConfig:function(){for(var t=[0],e=0,o=this.floorRate,r=0;r<o.length;r++){var i=o[r].rate;if(\"number\"!=typeof i)throw new TypeError(\"rate type error\");e+=i,t.push(e)}if(100!==e)throw new RangeError(\"rate 加起来务必等于100!\");this._floorRateArray=t},getRandowFloor:function(t){for(var e=100*Math.random(),o=0;o<t.length-1;o++)if(e>=t[o]&&e<t[o+1])return this.floorRate[o]},createFloorSpan:function(){var t=this._floorScrollerY+=this.floorDeltaY,e=Math.random()*(this.canvasWidth-this.floorWidth),o='<i class=\"floor '+this.getRandowFloor(this._floorRateArray).name+'\"></i>';$(o).css({top:t,left:e,width:this.floorWidth,height:this.floorHeight}).appendTo(this.$scroller)},removeFloorSapn:function(){$(\".floor\").eq(0).remove(),this.floorScore++,this.updateScore()},updateBlood:function(){for(var t=$(\".blood i\"),e=0;e<t.length;e++)e<this.blood?t.eq(e).removeClass(\"lose\"):t.eq(e).addClass(\"lose\")},updateScore:function(){this.$container.trigger(\"scoreupdate\"),$(\".text-score\").text(this.floorScore)},loseBlood:function(){if(!this.__onFloor){if(this.blood-=0,this.$people.addClass(\"danger\"),setTimeout(function(){this.$people.removeClass(\"danger\")}.bind(this),1e3),$(\"#game-ct\").addClass(\"danger\"),setTimeout(function(){$(\"#game-ct\").removeClass(\"danger\")},100),this.blood<=0)return this.blood=0,this.updateBlood(),void this.gameover();this.updateBlood()}},addBlood:function(){this.__onFloor||this.blood>=12||(this.blood+=1,this.updateBlood())},floorNormal:function(){this.addBlood()},floorNail:function(){this.loseBlood()},floorWeak:function(t){this.addBlood(),setTimeout(function(){t.addClass(\"over\"),t[0].cross=!0},200)},floorScroll:function(t){this.addBlood(),this.__floorScrollDirection=t},floorScrollEnd:function(){this.__floorScrollDirection=null},floorSpring:function(){this.__$currentJumpFloor=$floorEle,this.jumpStart(),this.addBlood()},jumpStart:function(){this.__jumpMode=!0,this.__$currentJumpFloor.addClass(\"up\"),setTimeout(function(){this.__$currentJumpFloor.removeClass(\"up\")}.bind(this),200)},jumpEnd:function(t){this.__jumpMode&&(t&&(this.__$currentJumpFloor[0].cross=!0),this._currentJumpDistance=0,this.__jumpMode=!1)},people:function(t){var e=1/t,o=this._v0*e+this.gravity*e*e/2;this._t+=e,this._v0=this.gravity*this._t;var r=this.speed/t,i=this.peopleVerticalSpeed/t,s=$(\".floor\"),n=this.$people.offset();if(n.top>this.canvasHeight)this.gameover();else{for(var l=0;l<s.length;l++){var h=s.eq(l).offset(),a=Math.abs(n.top+this.peopleHeight-h.top);if(n.top<=o+r){this._t=0,this.__onFloor=!1,this.jumpEnd(!0),this.loseBlood();break}if(!this.__jumpMode&&!s.eq(l)[0].cross&&a<=o+r&&n.left>h.left-this.peopleWidth&&n.left<h.left+this.floorWidth){this._currentPeopleY=h.top-this.peopleHeight,s.eq(l).hasClass(\"normal\")&&this.floorNormal(),s.eq(l).hasClass(\"nail\")&&this.floorNail(),s.eq(l).hasClass(\"spring\")&&this.floorSpring(s.eq(l)),s.eq(l).hasClass(\"weak\")&&this.floorWeak(s.eq(l)),s.eq(l).hasClass(\"scroll-left\")&&this.floorScroll(\"left\"),s.eq(l).hasClass(\"scroll-right\")&&this.floorScroll(\"right\"),this._t=0,this.__onFloor=!0;break}l===s.length-1&&(this.__onFloor=!1)}this.__jumpMode&&(this._currentJumpDistance>=this._maxJumpDistance?this.jumpEnd():(this._currentJumpDistance+=o,this._currentPeopleY-=o+r)),this.__onFloor||this.__jumpMode||(this.floorScrollEnd(),this._currentPeopleY+=o);var p=i;this._peopleGoLeft&&(\"left\"===this.__floorScrollDirection&&(p*=1.5),\"right\"===this.__floorScrollDirection&&(p*=1.5),this._currentPeopleVertical>0&&(this._currentPeopleVertical-=p)),this._peopleGoRight&&(\"left\"===this.__floorScrollDirection&&(p*=.5),\"right\"===this.__floorScrollDirection&&(p*=.5),this._currentPeopleVertical<this.canvasWidth-this.peopleWidth&&(this._currentPeopleVertical+=p)),this._peopleGoRight||this._peopleGoLeft||(p*=.5,\"left\"===this.__floorScrollDirection&&this._currentPeopleVertical>0&&(this._currentPeopleVertical-=p),\"right\"===this.__floorScrollDirection&&this._currentPeopleVertical<this.canvasWidth-this.peopleWidth&&(this._currentPeopleVertical+=p)),this.peopleUpdateView()}},floorUpdateView:function(){Modernizr.csstransforms3d?this.$scroller.css({\"-webkit-transform\":\"transform3d(0,\"+this._currentScrollerY+\",0)\",\"-ms-transform\":\"transform3d(0,\"+this._currentScrollerY+\",0)\",transform:\"transform3d(0,\"+this._currentScrollerY+\",0)\"}):Modernizr.csstransforms?this.$scroller.css({\"-webkit-transform\":\"transformY(\"+this._currentScrollerY+\")\",\"-ms-transform\":\"transformY(\"+this._currentScrollerY+\")\",transform:\"transformY(\"+this._currentScrollerY+\")\"}):this.$scroller.css({top:this._currentScrollerY+\"px\"})},peopleUpdateView:function(){this.__onFloor&&(this._peopleGoLeft&&(this.peopleRotateZ-=this.peopleRotateDelta),this._peopleGoRight&&(this.peopleRotateZ+=this.peopleRotateDelta)),Modernizr.csstransforms3d?this.$people.css({\"-webkit-transform\":\"transform3d(\"+this._currentPeopleVertical+\"px,\"+this._currentPeopleY+\"px,0)\",\"-ms-transform\":\"transform3d(\"+this._currentPeopleVertical+\"px,\"+this._currentPeopleY+\"px,0)\",transform:\"transform3d(\"+this._currentPeopleVertical+\"px,\"+this._currentPeopleY+\"px,0)\"}):Modernizr.csstransforms?this.$people.css({\"-webkit-transform\":\"transform(\"+this._currentPeopleVertical+\"px,\"+this._currentPeopleY+\"px,0)\",\"-ms-transform\":\"transform(\"+this._currentPeopleVertical+\"px,\"+this._currentPeopleY+\"px,0)\",transform:\"transform(\"+this._currentPeopleVertical+\"px,\"+this._currentPeopleY+\"px,0)\"}):this.$people.css({left:this._currentPeopleVertical+\"px\",top:this._currentPeopleY+\"px\"})},peopleUserController:function(){var t=this;$(window).keydown(function(e){if(\"ArrowRight\"===ev.key)return t._peopleGoRight=!0,void(t._peopleGoLeft=!1);\"ArrowLeft\"===ev.key&&(t._peopleGoRight=!1,t._peopleGoLeft=!0)}).keyup(function(e){\"ArrowRight\"===e.key&&(t._peopleGoRight=!1,retrun),\"ArrowLeft\"!==e.key||(t._peopleGoLeft=!1)}),$(\".controller .left-ct\").on(\"touchstart\",function(e){t._peopleGoRight=!1,t._peopleGoLeft=!0}).on(\"tounchend\",function(e){t._peopleGoLeft=!1}),$(\".controller .right-ct\").on(\"touchstart\",function(e){t._peopleGoRight=!0,t._peopleGoLeft=!0}).on(\"touchend\",function(e){t._peopleGoRight=!1})},core:function(t){var e=this.speed/t,o=$(\".floor\");if(this._currentScrollerY-=e,this._currentScrollerY<=2*-this.canvasHeight){this._currentScrollerY+=this.canvasHeight,this._floorScrollerY-=this.canvasHeight;for(var r=0;r<o.length;r++)o.eq(r).css({top:parseInt($(\".floor\").eq(r).css(\"top\"))-this.canvasHeight})}this.floorUpdateView(),o.eq(0).offset().top<=-20&&(this.createFloorSpan(),this.removeFloorSapn()),this.people(t),this.speed<=this.maxSpeed&&(this.speed+=.1)},run:function(t){if(!this.animation){this._fps=t=t||60;var e=1e3/t,o=this;return this.animation=setTimeout(function(){window.requestAnimationFrame(function(){o.core(t)}),o.runAnimation()},e)}console.error(\"Animation has aready in process,please do not run again!\")},stop:function(){clearTimeout(this.animation),this.animation=void 0,this.$container.trigger(\"stop\")},reRun:function(){this.$container.trigger(\"rerun\"),$.extend(this,this.__paramBackup),$(\".floor\").remove(),this.start()},backup:function(){for(var t in this.__paramBackup={},this)\"number\"!=typeof this[t]&&\"string\"!=typeof this[t]||(this.__paramBackup[t]=this[t])},start:function(){var t=0;for(this.$container.trigger(\"start\"),this.canvasWidth=this.$canvas.width(),this.canvasHeight=this.$canvas.height(),this.floorDeltaY=this.canvasHeight/11,this.floorWidth=this.canvasWidth/5,this.floorHeight=this.floorWidth/9,this.peopleHeight=parseInt(this.$people.css(\"height\")),this.peopleWidth=parseInt(this.$people.css(\"width\")),this._currentPeopleVertical=this.canvasWidth/2+this.peopleWidth/2,this.backup();t++<13;)this.createFloorSpan();this.peopleUserController(),this.peopleUpdateView(),this.updateBlood(),this.updateScore(),this.run(this.fps)}},e.default=r}});","extractedComments":[]}
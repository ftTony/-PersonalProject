{"map":"{\"version\":3,\"sources\":[\"/Users/tony/Documents/notes/floors/app/js/game_controller.js\"],\"names\":[\"__webpack_require__\",\"window\",\"requestAnimationFrame\",\"webkitRequestAnimationFrame\",\"mozRequestAnimationFrame\",\"cb\",\"GameController\",\"this\",\"floorRate\",\"name\",\"rate\",\"fps\",\"speed\",\"maxSpeed\",\"gravity\",\"peopleVerticalSpeed\",\"animation\",\"canvasWidth\",\"canvasHeight\",\"floorWidth\",\"floorHeight\",\"floorDeltaY\",\"floorScore\",\"blood\",\"$container\",\"$\",\"$canvas\",\"$scroller\",\"$people\",\"peopleRotateZ\",\"peopleRotateDelta\",\"peopleHeight\",\"peopleWidth\",\"_t\",\"_currentScrollerY\",\"_currentPeopleY\",\"_currentPeopleVertical\",\"_floorScrollerY\",\"_maxJumpDistance\",\"_frameIndex\",\"_v0\",\"checkFloorConfig\",\"prototype\",\"constructor\",\"Event\",\"on\",\"event\",\"fn\",\"indexOf\",\"gameover\",\"stop\",\"setTimeout\",\"hide\",\"show\",\"bind\",\"rangeArray\",\"totalRate\",\"config\",\"i\",\"length\",\"_rate\",\"TypeError\",\"push\",\"RangeError\",\"_floorRateArray\",\"getRandowFloor\",\"dice\",\"Math\",\"random\",\"createFloorSpan\",\"_top\",\"_left\",\"floorElement\",\"css\",\"top\",\"left\",\"width\",\"height\",\"appendTo\",\"removeFloorSapn\",\"eq\",\"remove\",\"updateScore\",\"updateBlood\",\"$bloodEle\",\"removeClass\",\"addClass\",\"trigger\",\"text\",\"loseBlood\",\"__onFloor\",\"addBlood\",\"floorNormal\",\"floorNail\",\"floorWeak\",\"$floorEle\",\"cross\",\"floorScroll\",\"direction\",\"__floorScrollDirection\",\"floorScrollEnd\",\"floorSpring\",\"__$currentJumpFloor\",\"jumpStart\",\"__jumpMode\",\"jumpEnd\",\"hitTop\",\"_currentJumpDistance\",\"people\",\"dt\",\"_deltaPeopleY\",\"_deltaY\",\"_deltaPeopleVertical\",\"$floor\",\"peopleOffset\",\"offset\",\"floorOffset\",\"distanceGap\",\"abs\",\"hasClass\",\"__temp_deltaPeopleVertical\",\"_peopleGoLeft\",\"_peopleGoRight\",\"peopleUpdateView\",\"floorUpdateView\",\"Modernizr\",\"csstransforms3d\",\"-webkit-transform\",\"-ms-transform\",\"transform\",\"csstransforms\",\"peopleUserController\",\"_this\",\"keydown\",\"ev\",\"key\",\"keyup\",\"retrun\",\"core\",\"parseInt\",\"run\",\"_fps\",\"looptime\",\"runAnimation\",\"console\",\"error\",\"clearTimeout\",\"undefined\",\"reRun\",\"extend\",\"__paramBackup\",\"start\",\"backup\",\"floorLoop\"],\"mappings\":\"qGAAAA,EAAA,GAEAC,OAAOC,sBAAwBD,OAAOC,uBAAyBD,OAAOE,6BAA+BF,OAAOG,0BAA4B,SAAUC,GAC9IA,KAGJ,IAAIC,EAAiB,WACjBC,KAAKC,YACGC,KAAM,SACNC,KAAM,KAGND,KAAM,SACNC,KAAM,KAGND,KAAM,OACNC,KAAM,KAGND,KAAM,gBACNC,KAAM,KAGND,KAAM,iBACNC,KAAM,KAGND,KAAM,OACNC,KAAM,KAGdH,KAAKI,IAAM,GACXJ,KAAKK,MAAQ,GACbL,KAAKM,SAAW,IAChBN,KAAKO,QAAQ,IACbP,KAAKQ,oBAAsB,IAC3BR,KAAKS,UAAY,KACjBT,KAAKU,YAAc,EACnBV,KAAKW,aAAe,EACpBX,KAAKY,WAAa,EAClBZ,KAAKa,YAAc,EACnBb,KAAKc,YAAc,GACnBd,KAAKe,WAAa,EAClBf,KAAKgB,MAAQ,GACbhB,KAAKiB,WAAaC,EAAE,cACpBlB,KAAKmB,QAAUD,EAAE,gBACjBlB,KAAKoB,UAAYF,EAAE,aACnBlB,KAAKqB,QAAUH,EAAE,WACjBlB,KAAKsB,cAAgB,EACrBtB,KAAKuB,kBAAoB,GACzBvB,KAAKwB,aAAe,EACpBxB,KAAKyB,YAAc,EACnBzB,KAAK0B,GAAK,EACV1B,KAAK2B,kBAAoB,EACzB3B,KAAK4B,gBAAkB,GACvB5B,KAAK6B,uBAAyB,EAC9B7B,KAAK8B,gBAAkB,IACvB9B,KAAK+B,iBAAmB,EACxB/B,KAAKgC,YAAc,EACnBhC,KAAKiC,IAAM,EACXjC,KAAKkC,oBAGTnC,EAAeoC,WACXC,YAAarC,EACbsC,OACI,WACA,QACA,QACA,OACA,eAEJC,GAAI,SAAUC,EAAOC,IACkB,IAA/BxC,KAAKqC,MAAMI,QAAQF,IACvBvC,KAAKiB,WAAWqB,GAAGC,EAAOC,IAK9BE,SAAU,WACN1C,KAAK2C,OACLC,WAAW,WACP1B,EAAE,YAAY2B,OACd3B,EAAE,cAAc4B,QAClBC,KAAK/C,MAAO,MAElBkC,iBAAkB,WAKd,IAJA,IAAIc,GAAc,GACdC,EAAY,EACZC,EAASlD,KAAKC,UAETkD,EAAI,EAAGA,EAAID,EAAOE,OAAQD,IAAK,CACpC,IAAIE,EAAQH,EAAOC,GAAGhD,KACtB,GAAqB,iBAAVkD,EACP,MAAM,IAAIC,UAAU,mBAExBL,GAAaI,EACbL,EAAWO,KAAKN,GAEpB,GAAkB,MAAdA,EACA,MAAM,IAAIO,WAAW,oBAEzBxD,KAAKyD,gBAAkBT,GAE3BU,eAAgB,SAAUV,GAEtB,IADA,IAAIW,EAAuB,IAAhBC,KAAKC,SACPV,EAAI,EAAGA,EAAIH,EAAWI,OAAS,EAAGD,IACvC,GAAIQ,GAAQX,EAAWG,IAAMQ,EAAOX,EAAWG,EAAI,GAC/C,OAAOnD,KAAKC,UAAUkD,IAOlCW,gBAAiB,WACb,IAAIC,EAAO/D,KAAK8B,iBAAmB9B,KAAKc,YACpCkD,EAAQJ,KAAKC,UAAY7D,KAAKU,YAAcV,KAAKY,YAEjDqD,EAAe,mBADDjE,KAAK0D,eAAe1D,KAAKyD,iBACSvD,KAAO,SAE3DgB,EAAE+C,GAAcC,KACZC,IAAKJ,EACLK,KAAMJ,EACNK,MAAOrE,KAAKY,WACZ0D,OAAQtE,KAAKa,cACd0D,SAASvE,KAAKoB,YAKrBoD,gBAAiB,WACbtD,EAAE,UAAUuD,GAAG,GAAGC,SAClB1E,KAAKe,aACLf,KAAK2E,eAKTC,YAAa,WAET,IADA,IAAIC,EAAY3D,EAAE,YACTiC,EAAI,EAAGA,EAAI0B,EAAUzB,OAAQD,IAC9BA,EAAInD,KAAKgB,MACT6D,EAAUJ,GAAGtB,GAAG2B,YAAY,QAE5BD,EAAUJ,GAAGtB,GAAG4B,SAAS,SAOrCJ,YAAa,WACT3E,KAAKiB,WAAW+D,QAAQ,eACxB9D,EAAE,eAAe+D,KAAKjF,KAAKe,aAK/BmE,UAAW,WACP,IAAIlF,KAAKmF,UAAT,CAcA,GAbAnF,KAAKgB,OAAS,EAEdhB,KAAKqB,QAAQ0D,SAAS,UACtBnC,WAAW,WACP5C,KAAKqB,QAAQyD,YAAY,WAC3B/B,KAAK/C,MAAO,KAGdkB,EAAE,YAAY6D,SAAS,UACvBnC,WAAW,WACP1B,EAAE,YAAY4D,YAAY,WAC3B,KAEC9E,KAAKgB,OAAS,EAId,OAHAhB,KAAKgB,MAAQ,EACbhB,KAAK4E,mBACL5E,KAAK0C,WAGT1C,KAAK4E,gBAETQ,SAAU,WAEFpF,KAAKmF,WAAanF,KAAKgB,OAAS,KACpChB,KAAKgB,OAAS,EACdhB,KAAK4E,gBAETS,YAAa,WACTrF,KAAKoF,YAETE,UAAW,WACPtF,KAAKkF,aAETK,UAAW,SAAUC,GACjBxF,KAAKoF,WACLxC,WAAW,WACP4C,EAAUT,SAAS,QACnBS,EAAU,GAAGC,OAAQ,GACtB,MAEPC,YAAa,SAAUC,GACnB3F,KAAKoF,WACLpF,KAAK4F,uBAAyBD,GAElCE,eAAgB,WACZ7F,KAAK4F,uBAAyB,MAElCE,YAAa,WACT9F,KAAK+F,oBAAsBP,UAC3BxF,KAAKgG,YACLhG,KAAKoF,YAETY,UAAW,WACPhG,KAAKiG,YAAa,EAClBjG,KAAK+F,oBAAoBhB,SAAS,MAClCnC,WAAW,WACP5C,KAAK+F,oBAAoBjB,YAAY,OACvC/B,KAAK/C,MAAO,MAElBkG,QAAS,SAAUC,GACVnG,KAAKiG,aAGNE,IACAnG,KAAK+F,oBAAoB,GAAGN,OAAQ,GAGxCzF,KAAKoG,qBAAuB,EAE5BpG,KAAKiG,YAAa,IAEtBI,OAAQ,SAAUjG,GAEd,IAAIkG,EAAK,EAAIlG,EAETmG,EAAgBvG,KAAKiC,IAAMqE,EAAKtG,KAAKO,QAAW+F,EAAOA,EAAM,EAEjEtG,KAAK0B,IAAM4E,EAEXtG,KAAKiC,IAAMjC,KAAKO,QAAUP,KAAK0B,GAE/B,IAAI8E,EAAUxG,KAAKK,MAAQD,EAEvBqG,EAAuBzG,KAAKQ,oBAAsBJ,EAElDsG,EAASxF,EAAE,UAEXyF,EAAe3G,KAAKqB,QAAQuF,SAGhC,GAAID,EAAaxC,IAAMnE,KAAKW,aACxBX,KAAK0C,eADT,CAKA,IAAK,IAAIS,EAAI,EAAGA,EAAIuD,EAAOtD,OAAQD,IAAK,CAEpC,IAAI0D,EAAcH,EAAOjC,GAAGtB,GAAGyD,SAE3BE,EAAclD,KAAKmD,IAAIJ,EAAaxC,IAAMnE,KAAKwB,aAAeqF,EAAY1C,KAE9E,GAAIwC,EAAaxC,KAAOoC,EAAgBC,EAAS,CAC7CxG,KAAK0B,GAAK,EACV1B,KAAKmF,WAAY,EACjBnF,KAAKkG,SAAQ,GACblG,KAAKkF,YACL,MAGJ,IAAKlF,KAAKiG,aAELS,EAAOjC,GAAGtB,GAAG,GAAGsC,OAEjBqB,GAAeP,EAAgBC,GAE/BG,EAAavC,KAAOyC,EAAYzC,KAAOpE,KAAKyB,aAE5CkF,EAAavC,KAAOyC,EAAYzC,KAAOpE,KAAKY,WAAY,CAExDZ,KAAK4B,gBAAkBiF,EAAY1C,IAAMnE,KAAKwB,aAE1CkF,EAAOjC,GAAGtB,GAAG6D,SAAS,WACtBhH,KAAKqF,cAELqB,EAAOjC,GAAGtB,GAAG6D,SAAS,SACtBhH,KAAKsF,YAELoB,EAAOjC,GAAGtB,GAAG6D,SAAS,WACtBhH,KAAK8F,YAAYY,EAAOjC,GAAGtB,IAE3BuD,EAAOjC,GAAGtB,GAAG6D,SAAS,SACtBhH,KAAKuF,UAAUmB,EAAOjC,GAAGtB,IAEzBuD,EAAOjC,GAAGtB,GAAG6D,SAAS,gBACtBhH,KAAK0F,YAAY,QAEjBgB,EAAOjC,GAAGtB,GAAG6D,SAAS,iBACtBhH,KAAK0F,YAAY,SAErB1F,KAAK0B,GAAK,EACV1B,KAAKmF,WAAY,EACjB,MAGAhC,IAAMuD,EAAOtD,OAAS,IACtBpD,KAAKmF,WAAY,GAKrBnF,KAAKiG,aACDjG,KAAKoG,sBAAwBpG,KAAK+B,iBAClC/B,KAAKkG,WAELlG,KAAKoG,sBAAwBG,EAE7BvG,KAAK4B,iBAAmB2E,EAAgBC,IAK3CxG,KAAKmF,WAAcnF,KAAKiG,aACzBjG,KAAK6F,iBACL7F,KAAK4B,iBAAmB2E,GAI5B,IAAIU,EAA6BR,EAE7BzG,KAAKkH,gBAC+B,SAAhClH,KAAK4F,yBACLqB,GAA8B,KAEE,UAAhCjH,KAAK4F,yBACLqB,GAA8B,KAE9BjH,KAAK6B,uBAAyB,IAC9B7B,KAAK6B,wBAA0BoF,IAInCjH,KAAKmH,iBAC+B,SAAhCnH,KAAK4F,yBACLqB,GAA8B,IAEE,UAAhCjH,KAAK4F,yBACLqB,GAA8B,IAE9BjH,KAAK6B,uBAAyB7B,KAAKU,YAAcV,KAAKyB,cACtDzB,KAAK6B,wBAA0BoF,IAIlCjH,KAAKmH,gBAAmBnH,KAAKkH,gBAC9BD,GAA8B,GACM,SAAhCjH,KAAK4F,wBACD5F,KAAK6B,uBAAyB,IAC9B7B,KAAK6B,wBAA0BoF,GAGH,UAAhCjH,KAAK4F,wBACD5F,KAAK6B,uBAAyB7B,KAAKU,YAAcV,KAAKyB,cACtDzB,KAAK6B,wBAA0BoF,IAK3CjH,KAAKoH,qBAGTC,gBAAiB,WACTC,UAAUC,gBACVvH,KAAKoB,UAAU8C,KACXsD,oBAAqB,iBAAmBxH,KAAK2B,kBAAoB,QACjE8F,gBAAiB,iBAAmBzH,KAAK2B,kBAAoB,QAC7D+F,UAAa,iBAAmB1H,KAAK2B,kBAAoB,UAEtD2F,UAAUK,cACjB3H,KAAKoB,UAAU8C,KACXsD,oBAAqB,cAAgBxH,KAAK2B,kBAAoB,MAC9D8F,gBAAiB,cAAgBzH,KAAK2B,kBAAoB,MAC1D+F,UAAa,cAAgB1H,KAAK2B,kBAAoB,QAG1D3B,KAAKoB,UAAU8C,KACXC,IAAOnE,KAAK2B,kBAAoB,QAI5CyF,iBAAkB,WACVpH,KAAKmF,YACDnF,KAAKkH,gBACLlH,KAAKsB,eAAiBtB,KAAKuB,mBAE3BvB,KAAKmH,iBACLnH,KAAKsB,eAAiBtB,KAAKuB,oBAG/B+F,UAAUC,gBACVvH,KAAKqB,QAAQ6C,KACTsD,oBAAqB,eAAiBxH,KAAK6B,uBAAyB,MAAQ7B,KAAK4B,gBAAkB,QACnG6F,gBAAiB,eAAiBzH,KAAK6B,uBAAyB,MAAQ7B,KAAK4B,gBAAkB,QAC/F8F,UAAa,eAAiB1H,KAAK6B,uBAAyB,MAAQ7B,KAAK4B,gBAAkB,UAExF0F,UAAUK,cACjB3H,KAAKqB,QAAQ6C,KACTsD,oBAAqB,aAAexH,KAAK6B,uBAAyB,MAAQ7B,KAAK4B,gBAAkB,MACjG6F,gBAAiB,aAAezH,KAAK6B,uBAAyB,MAAQ7B,KAAK4B,gBAAkB,MAC7F8F,UAAa,aAAe1H,KAAK6B,uBAAyB,MAAQ7B,KAAK4B,gBAAkB,QAG7F5B,KAAKqB,QAAQ6C,KACTE,KAAQpE,KAAK6B,uBAAyB,KACtCsC,IAAOnE,KAAK4B,gBAAkB,QAI1CgG,qBAAsB,WAClB,IAAIC,EAAQ7H,KACZkB,EAAExB,QAAQoI,QAAQ,SAAUC,GACxB,GAAe,eAAXA,EAAGC,IAGH,OAFAH,EAAMV,gBAAiB,OACvBU,EAAMX,eAAgB,GAGX,cAAXa,EAAGC,MACHH,EAAMV,gBAAiB,EACvBU,EAAMX,eAAgB,KAE3Be,MAAM,SAAUF,GACA,eAAXA,EAAGC,MACHH,EAAMV,gBAAiB,EACvBe,QAEW,cAAXH,EAAGC,MACHH,EAAMX,eAAgB,KAK9BhG,EAAE,wBAAwBoB,GAAG,aAAc,SAAUyF,GACjDF,EAAMV,gBAAiB,EACvBU,EAAMX,eAAgB,IACvB5E,GAAG,YAAa,SAAUyF,GACzBF,EAAMX,eAAgB,IAG1BhG,EAAE,yBAAyBoB,GAAG,aAAc,SAAUyF,GAClDF,EAAMV,gBAAiB,EACvBU,EAAMX,eAAgB,IACvB5E,GAAG,WAAY,SAAUyF,GACxBF,EAAMV,gBAAiB,KAG/BgB,KAAM,SAAU/H,GACZ,IACIoG,EAAUxG,KAAKK,MAAQD,EACvBsG,EAASxF,EAAE,UAMf,GAHAlB,KAAK2B,mBAAqB6E,EAGtBxG,KAAK2B,mBAA0C,GAApB3B,KAAKW,aAAkB,CAElDX,KAAK2B,mBAAqB3B,KAAKW,aAE/BX,KAAK8B,iBAAmB9B,KAAKW,aAE7B,IAAK,IAAIwC,EAAI,EAAGA,EAAIuD,EAAOtD,OAAQD,IAC/BuD,EAAOjC,GAAGtB,GAAGe,KACTC,IAAKiE,SAASlH,EAAE,UAAUuD,GAAGtB,GAAGe,IAAI,QAAUlE,KAAKW,eAK/DX,KAAKqH,kBAGDX,EAAOjC,GAAG,GAAGmC,SAASzC,MAAQ,KAC9BnE,KAAK8D,kBACL9D,KAAKwE,mBAITxE,KAAKqG,OAAOjG,GAERJ,KAAKK,OAASL,KAAKM,WACnBN,KAAKK,OAAS,KAGtBgI,IAAK,SAAUjI,GACX,IAAIJ,KAAKS,UAAT,CAKAT,KAAKsI,KAAOlI,EAAMA,GAAO,GACzB,IAAImI,EAAW,IAAOnI,EAClByH,EAAQ7H,KAUZ,OAAOA,KAAKS,UARO,SAAf+H,IACA,OAAO5F,WAAW,WACdlD,OAAOC,sBAAsB,WACzBkI,EAAMM,KAAK/H,KAEfyH,EAAMpH,UAAY+H,KACnBD,GAEiBC,GAhBpBC,QAAQC,MAAM,6DAkBtB/F,KAAM,WACFgG,aAAa3I,KAAKS,WAClBT,KAAKS,eAAYmI,EACjB5I,KAAKiB,WAAW+D,QAAQ,SAE5B6D,MAAO,WACH7I,KAAKiB,WAAW+D,QAAQ,SAExB9D,EAAE4H,OAAO9I,KAAMA,KAAK+I,eAEpB7H,EAAE,UAAUwD,SAEZ1E,KAAKgJ,SAETC,OAAQ,WAGJ,IAAK,IAAI9F,KADTnD,KAAK+I,iBACS/I,KACa,iBAAZA,KAAKmD,IAAsC,iBAAZnD,KAAKmD,KAC3CnD,KAAK+I,cAAc5F,GAAKnD,KAAKmD,KAIzC6F,MAAO,WACH,IACIE,EAAY,EAahB,IAZAlJ,KAAKiB,WAAW+D,QAAQ,SACxBhF,KAAKU,YAAcV,KAAKmB,QAAQkD,QAChCrE,KAAKW,aAAeX,KAAKmB,QAAQmD,SACjCtE,KAAKc,YAAcd,KAAKW,aAAe,GACvCX,KAAKY,WAAaZ,KAAKU,YAAc,EACrCV,KAAKa,YAAcb,KAAKY,WAAa,EACrCZ,KAAKwB,aAAe4G,SAASpI,KAAKqB,QAAQ6C,IAAI,WAC9ClE,KAAKyB,YAAc2G,SAASpI,KAAKqB,QAAQ6C,IAAI,UAE7ClE,KAAK6B,uBAAyB7B,KAAKU,YAAc,EAAIV,KAAKyB,YAAc,EACxEzB,KAAKiJ,SAEEC,IAAc,IACjBlJ,KAAK8D,kBAGT9D,KAAK4H,uBAEL5H,KAAKoH,mBAELpH,KAAK4E,cAEL5E,KAAK2E,cAEL3E,KAAKqI,IAAIrI,KAAKI,iBAIPL\",\"sourcesContent\":[\"import './zepto-touch';\\n\\nwindow.requestAnimationFrame = window.requestAnimationFrame || window.webkitRequestAnimationFrame || window.mozRequestAnimationFrame || function (cb) {\\n    cb();\\n}\\n\\nvar GameController = function () {\\n    this.floorRate = [{\\n            name: 'normal',\\n            rate: 15,\\n        },\\n        {\\n            name: 'spring',\\n            rate: 15\\n        },\\n        {\\n            name: 'weak',\\n            rate: 15\\n        },\\n        {\\n            name: 'scroller-left',\\n            rate: 10\\n        },\\n        {\\n            name: 'scroller-right',\\n            rate: 10\\n        },\\n        {\\n            name: 'nail',\\n            rate: 35\\n        },\\n    ];\\n    this.fps = 60; //刷新频率\\n    this.speed = 50; //卷轴初始速度\\n    this.maxSpeed = 350; //卷轴最大速度\\n    this.gravity=1000;  //重力加速度px每秒平方\\n    this.peopleVerticalSpeed = 200; //人物横向移动速度\\n    this.animation = null;\\n    this.canvasWidth = 0; //画布宽度\\n    this.canvasHeight = 0; //画面高度\\n    this.floorWidth = 0; //楼层宽度\\n    this.floorHeight = 0; //楼层高度\\n    this.floorDeltaY = 50;\\n    this.floorScore = 1;\\n    this.blood = 12; //人物血量\\n    this.$container = $('.container');\\n    this.$canvas = $('.game-canvas');\\n    this.$scroller = $('.scroller');\\n    this.$people = $('.people');\\n    this.peopleRotateZ = 0;\\n    this.peopleRotateDelta = 25; //小球滚动角度\\n    this.peopleHeight = 0;\\n    this.peopleWidth = 0;\\n    this._t = 0;\\n    this._currentScrollerY = 0;\\n    this._currentPeopleY = 20;\\n    this._currentPeopleVertical = 0;\\n    this._floorScrollerY = 200;\\n    this._maxJumpDistance = 0;\\n    this._frameIndex = 0;\\n    this._v0 = 0;\\n    this.checkFloorConfig();\\n};\\n\\nGameController.prototype = {\\n    constructor: GameController,\\n    Event: [\\n        'gameover',\\n        'start',\\n        'rerun',\\n        'stop',\\n        'scoreupdate'\\n    ],\\n    on: function (event, fn) {\\n        if (this.Event.indexOf(event) === -1) return;\\n        this.$container.on(event, fn);\\n    },\\n    /**\\n     * 游戏结束\\n     */\\n    gameover: function () {\\n        this.stop();\\n        setTimeout(function () {\\n            $('#game-ct').hide();\\n            $('.game-over').show();\\n        }.bind(this), 200);\\n    },\\n    checkFloorConfig: function () {\\n        var rangeArray = [0];\\n        var totalRate = 0;\\n        var config = this.floorRate;\\n\\n        for (var i = 0; i < config.length; i++) {\\n            var _rate = config[i].rate;\\n            if (typeof _rate !== 'number') {\\n                throw new TypeError('rate type error');\\n            }\\n            totalRate += _rate;\\n            rangeArray.push(totalRate);\\n        }\\n        if (totalRate !== 100) {\\n            throw new RangeError('rate 加起来务必等于100!');\\n        }\\n        this._floorRateArray = rangeArray;\\n    },\\n    getRandowFloor: function (rangeArray) {\\n        var dice = Math.random() * 100;\\n        for (var i = 0; i < rangeArray.length - 1; i++) {\\n            if (dice >= rangeArray[i] && dice < rangeArray[i + 1]) {\\n                return this.floorRate[i];\\n            }\\n        }\\n    },\\n    /**\\n     * 创建楼层\\n     */\\n    createFloorSpan: function () {\\n        var _top = this._floorScrollerY += this.floorDeltaY,\\n            _left = Math.random() * (this.canvasWidth - this.floorWidth);\\n        var floorConfig = this.getRandowFloor(this._floorRateArray);\\n        var floorElement = '<i class=\\\"floor ' + floorConfig.name + '\\\"></i>';\\n\\n        $(floorElement).css({\\n            top: _top,\\n            left: _left,\\n            width: this.floorWidth,\\n            height: this.floorHeight\\n        }).appendTo(this.$scroller);\\n    },\\n    /**\\n     * 移除楼层\\n     */\\n    removeFloorSapn: function () {\\n        $('.floor').eq(0).remove();\\n        this.floorScore++;\\n        this.updateScore();\\n    },\\n    /**\\n     * 更改血\\n     */\\n    updateBlood: function () {\\n        var $bloodEle = $('.blood i');\\n        for (var i = 0; i < $bloodEle.length; i++) {\\n            if (i < this.blood) {\\n                $bloodEle.eq(i).removeClass('lose');\\n            } else {\\n                $bloodEle.eq(i).addClass('lose');\\n            }\\n        }\\n    },\\n    /**\\n     * 修改分数\\n     */\\n    updateScore: function () {\\n        this.$container.trigger('scoreupdate');\\n        $('.text-score').text(this.floorScore);\\n    },\\n    /**\\n     * 失分数\\n     */\\n    loseBlood: function () {\\n        if (this.__onFloor) return;\\n        this.blood -= 0;\\n        //人变红\\n        this.$people.addClass('danger');\\n        setTimeout(function () {\\n            this.$people.removeClass('danger');\\n        }.bind(this), 1000);\\n\\n        //背影闪烁\\n        $('#game-ct').addClass('danger');\\n        setTimeout(() => {\\n            $('#game-ct').removeClass('danger');\\n        }, 100);\\n\\n        if (this.blood <= 0) {\\n            this.blood = 0;\\n            this.updateBlood();\\n            this.gameover();\\n            return;\\n        }\\n        this.updateBlood();\\n    },\\n    addBlood: function () {\\n        //当人物在平台上时，或者血量大于12，不重复加血\\n        if (this.__onFloor || this.blood >= 12) return;\\n        this.blood += 1;\\n        this.updateBlood();\\n    },\\n    floorNormal: function () {\\n        this.addBlood();\\n    },\\n    floorNail: function () {\\n        this.loseBlood();\\n    },\\n    floorWeak: function ($floorEle) {\\n        this.addBlood();\\n        setTimeout(function () {\\n            $floorEle.addClass('over');\\n            $floorEle[0].cross = true;\\n        }, 200);\\n    },\\n    floorScroll: function (direction) {\\n        this.addBlood();\\n        this.__floorScrollDirection = direction;\\n    },\\n    floorScrollEnd: function () {\\n        this.__floorScrollDirection = null;\\n    },\\n    floorSpring: function () {\\n        this.__$currentJumpFloor = $floorEle;\\n        this.jumpStart();\\n        this.addBlood();\\n    },\\n    jumpStart: function () {\\n        this.__jumpMode = true;\\n        this.__$currentJumpFloor.addClass('up');\\n        setTimeout(function () {\\n            this.__$currentJumpFloor.removeClass('up');\\n        }.bind(this), 200);\\n    },\\n    jumpEnd: function (hitTop) {\\n        if (!this.__jumpMode) {\\n            return;\\n        }\\n        if (hitTop) {\\n            this.__$currentJumpFloor[0].cross = true;\\n        }\\n        //重置跳跃高度\\n        this._currentJumpDistance = 0;\\n        //解除跳跃\\n        this.__jumpMode = false;\\n    },\\n    people: function (fps) {\\n        //每帧消耗时间 ms\\n        var dt = 1 / fps;\\n        //人物纵向每帧移动距离 \\n        var _deltaPeopleY = this._v0 * dt + this.gravity * (dt) * (dt) / 2;\\n        //更新时间 t=t+dt;\\n        this._t += dt;\\n        // 更新速度 v=at\\n        this._v0 = this.gravity * this._t;\\n        //卷轴纵向每帧移动距离\\n        var _deltaY = this.speed / fps;\\n        //人物横向每帧移动距离\\n        var _deltaPeopleVertical = this.peopleVerticalSpeed / fps;\\n        // 缓存floor\\n        var $floor = $('.floor');\\n        //缓存offset\\n        var peopleOffset = this.$people.offset();\\n\\n        //人物掉落屏幕下方，游戏结束\\n        if (peopleOffset.top > this.canvasHeight) {\\n            this.gameover();\\n            return;\\n        }\\n        // 碰撞检测\\n        for (var i = 0; i < $floor.length; i++) {\\n            //缓存offset\\n            var floorOffset = $floor.eq(i).offset();\\n            //人物与楼梯纵向距离\\n            var distanceGap = Math.abs(peopleOffset.top + this.peopleHeight - floorOffset.top);\\n            // 当人物撞到顶部，掉血+掉落+打断跳跃\\n            if (peopleOffset.top <= _deltaPeopleY + _deltaY) {\\n                this._t = 0;\\n                this.__onFloor = false;\\n                this.jumpEnd(true);\\n                this.loseBlood();\\n                break;\\n            }\\n            // 跳跃模式不进入检测\\n            if (!this.__jumpMode &&\\n                //元素不可直接穿过\\n                !$floor.eq(i)[0].cross &&\\n                // 人物与楼梯纵向距离在一帧移动距离之内\\n                distanceGap <= _deltaPeopleY + _deltaY &&\\n                // 人物横向距离不超过楼梯最左\\n                peopleOffset.left > floorOffset.left - this.peopleWidth &&\\n                //人物横向距离不走过楼梯最右\\n                peopleOffset.left < floorOffset.left + this.floorWidth) {\\n                // 人物与楼梯偏差修正\\n                this._currentPeopleY = floorOffset.top - this.peopleHeight;\\n                // 施加各类楼梯特殊属性\\n                if ($floor.eq(i).hasClass('normal')) {\\n                    this.floorNormal();\\n                }\\n                if ($floor.eq(i).hasClass('nail')) {\\n                    this.floorNail();\\n                }\\n                if ($floor.eq(i).hasClass('spring')) {\\n                    this.floorSpring($floor.eq(i));\\n                }\\n                if ($floor.eq(i).hasClass('weak')) {\\n                    this.floorWeak($floor.eq(i));\\n                }\\n                if ($floor.eq(i).hasClass('scroll-left')) {\\n                    this.floorScroll('left');\\n                }\\n                if ($floor.eq(i).hasClass('scroll-right')) {\\n                    this.floorScroll('right');\\n                }\\n                this._t = 0;\\n                this.__onFloor = true;\\n                break;\\n            }\\n            //当循环执行完毕，仍然没有发现碰撞，则表明人物不在平台上\\n            if (i === $floor.length - 1) {\\n                this.__onFloor = false;\\n            }\\n        }\\n\\n        //人物向上跳起\\n        if (this.__jumpMode) {\\n            if (this._currentJumpDistance >= this._maxJumpDistance) {\\n                this.jumpEnd();\\n            } else {\\n                this._currentJumpDistance += _deltaPeopleY;\\n                // 向上跳起效果要额外加上_deltaY，以匹配卷轴运动状态\\n                this._currentPeopleY -= _deltaPeopleY + _deltaY;\\n            }\\n        }\\n\\n        // 人物向下坠落+取消楼梯左右加速状态\\n        if (!this.__onFloor && !this.__jumpMode) {\\n            this.floorScrollEnd();\\n            this._currentPeopleY += _deltaPeopleY;\\n        }\\n\\n        // 横向运动预处理\\n        var __temp_deltaPeopleVertical = _deltaPeopleVertical;\\n        //处理人物向左运动\\n        if (this._peopleGoLeft) {\\n            if (this.__floorScrollDirection === 'left') {\\n                __temp_deltaPeopleVertical *= 1.5;\\n            }\\n            if (this.__floorScrollDirection === 'right') {\\n                __temp_deltaPeopleVertical *= 1.5;\\n            }\\n            if (this._currentPeopleVertical > 0) {\\n                this._currentPeopleVertical -= __temp_deltaPeopleVertical;\\n            }\\n        }\\n        // 处理人物向右运动\\n        if (this._peopleGoRight) {\\n            if (this.__floorScrollDirection === 'left') {\\n                __temp_deltaPeopleVertical *= 0.5;\\n            }\\n            if (this.__floorScrollDirection === 'right') {\\n                __temp_deltaPeopleVertical *= 0.5;\\n            }\\n            if (this._currentPeopleVertical < this.canvasWidth - this.peopleWidth) {\\n                this._currentPeopleVertical += __temp_deltaPeopleVertical;\\n            }\\n        }\\n        // 处理人物在滚动楼梯上的自动运动\\n        if (!this._peopleGoRight && !this._peopleGoLeft) {\\n            __temp_deltaPeopleVertical *= 0.5;\\n            if (this.__floorScrollDirection === 'left') {\\n                if (this._currentPeopleVertical > 0) {\\n                    this._currentPeopleVertical -= __temp_deltaPeopleVertical;\\n                }\\n            }\\n            if (this.__floorScrollDirection === 'right') {\\n                if (this._currentPeopleVertical < this.canvasWidth - this.peopleWidth) {\\n                    this._currentPeopleVertical += __temp_deltaPeopleVertical;\\n                }\\n            }\\n        }\\n        //更新人视图\\n        this.peopleUpdateView();\\n    },\\n    //更新卷轴位置\\n    floorUpdateView: function () {\\n        if (Modernizr.csstransforms3d) {\\n            this.$scroller.css({\\n                '-webkit-transform': 'transform3d(0,' + this._currentScrollerY + 'px,0)',\\n                '-ms-transform': 'transform3d(0,' + this._currentScrollerY + 'px,0)',\\n                'transform': 'transform3d(0,' + this._currentScrollerY + 'px,0)'\\n            });\\n        } else if (Modernizr.csstransforms) {\\n            this.$scroller.css({\\n                '-webkit-transform': 'translateY(' + this._currentScrollerY + 'px)',\\n                '-ms-transform': 'translateY(' + this._currentScrollerY + 'px)',\\n                'transform': 'translateY(' + this._currentScrollerY + 'px)'\\n            });\\n        } else {\\n            this.$scroller.css({\\n                'top': this._currentScrollerY + 'px'\\n            });\\n        }\\n    },\\n    peopleUpdateView: function () {\\n        if (this.__onFloor) {\\n            if (this._peopleGoLeft) {\\n                this.peopleRotateZ -= this.peopleRotateDelta;\\n            }\\n            if (this._peopleGoRight) {\\n                this.peopleRotateZ += this.peopleRotateDelta;\\n            }\\n        }\\n        if (Modernizr.csstransforms3d) {\\n            this.$people.css({\\n                '-webkit-transform': 'transform3d(' + this._currentPeopleVertical + 'px,' + this._currentPeopleY + 'px,0)',\\n                '-ms-transform': 'transform3d(' + this._currentPeopleVertical + 'px,' + this._currentPeopleY + 'px,0)',\\n                'transform': 'transform3d(' + this._currentPeopleVertical + 'px,' + this._currentPeopleY + 'px,0)'\\n            });\\n        } else if (Modernizr.csstransforms) {\\n            this.$people.css({\\n                '-webkit-transform': 'translate(' + this._currentPeopleVertical + 'px,' + this._currentPeopleY + 'px)',\\n                '-ms-transform': 'translate(' + this._currentPeopleVertical + 'px,' + this._currentPeopleY + 'px)',\\n                'transform': 'translate(' + this._currentPeopleVertical + 'px,' + this._currentPeopleY + 'px)'\\n            });\\n        } else {\\n            this.$people.css({\\n                'left': this._currentPeopleVertical + 'px',\\n                'top': this._currentPeopleY + 'px'\\n            })\\n        }\\n    },\\n    peopleUserController: function () {\\n        var _this = this;\\n        $(window).keydown(function (ev) {\\n            if (ev.key === 'ArrowRight') {\\n                _this._peopleGoRight = true;\\n                _this._peopleGoLeft = false;\\n                return;\\n            }\\n            if (ev.key === 'ArrowLeft') {\\n                _this._peopleGoRight = false;\\n                _this._peopleGoLeft = true;\\n            }\\n        }).keyup(function (ev) {\\n            if (ev.key === 'ArrowRight') {\\n                _this._peopleGoRight = false;\\n                retrun;\\n            }\\n            if (ev.key === 'ArrowLeft') {\\n                _this._peopleGoLeft = false;\\n                return;\\n            }\\n        });\\n\\n        $('.controller .left-ct').on('touchstart', function (ev) {\\n            _this._peopleGoRight = false;\\n            _this._peopleGoLeft = true;\\n        }).on('tounchend', function (ev) {\\n            _this._peopleGoLeft = false;\\n        });\\n\\n        $('.controller .right-ct').on('touchstart', function (ev) {\\n            _this._peopleGoRight = true;\\n            _this._peopleGoLeft = true;\\n        }).on('touchend', function (ev) {\\n            _this._peopleGoRight = false;\\n        })\\n    },\\n    core: function (fps) {\\n        var _this = this,\\n            _deltaY = this.speed / fps, //卷轴纵向每帧移动距离\\n            $floor = $('.floor');\\n\\n        //计算卷轴位置\\n        this._currentScrollerY -= _deltaY;\\n\\n        //当卷轴超出一定长度之后，进行位置reset，缩减长度，防止Crash现象\\n        if (this._currentScrollerY <= -this.canvasHeight * 2) {\\n            //将卷轴滚动高度减小一屏\\n            this._currentScrollerY += this.canvasHeight;\\n            //将楼梯偏移高度减少一屏\\n            this._floorScrollerY -= this.canvasHeight;\\n            //重置再有楼梯位置\\n            for (var i = 0; i < $floor.length; i++) {\\n                $floor.eq(i).css({\\n                    top: parseInt($('.floor').eq(i).css('top')) - this.canvasHeight\\n                });\\n            }\\n        }\\n        //更新卷轴位置\\n        this.floorUpdateView();\\n\\n        //每个台阶移出视野则清除台阶，并且在底部增加一个新的台阶\\n        if ($floor.eq(0).offset().top <= -20) {\\n            this.createFloorSpan();\\n            this.removeFloorSapn();\\n        }\\n\\n        //调用人物渲染\\n        this.people(fps);\\n        //起来越high\\n        if (this.speed <= this.maxSpeed) {\\n            this.speed += 0.1;\\n        }\\n    },\\n    run: function (fps) {\\n        if (this.animation) {\\n            console.error('Animation has aready in process,please do not run again!');\\n            return;\\n        }\\n\\n        this._fps = fps = fps || 60;\\n        var looptime = 1000 / fps;\\n        var _this = this;\\n\\n        var runAnimation = function () {\\n            return setTimeout(function () {\\n                window.requestAnimationFrame(function () {\\n                    _this.core(fps);\\n                });\\n                _this.animation = runAnimation();\\n            }, looptime);\\n        };\\n        return this.animation = runAnimation();\\n    },\\n    stop: function () {\\n        clearTimeout(this.animation); //暂停动画\\n        this.animation = undefined;\\n        this.$container.trigger('stop');\\n    },\\n    reRun: function () {\\n        this.$container.trigger('rerun');\\n        //重置参数\\n        $.extend(this, this.__paramBackup);\\n        //删除掉再有楼梯\\n        $('.floor').remove();\\n        //重新初始化\\n        this.start();\\n    },\\n    backup: function () {\\n        // 备份寝设置参数，用于游戏reset\\n        this.__paramBackup = {};\\n        for (var i in this) {\\n            if (typeof this[i] === 'number' || typeof this[i] === 'string') {\\n                this.__paramBackup[i] = this[i];\\n            }\\n        }\\n    },\\n    start: function () {\\n        var _this = this,\\n            floorLoop = 0;\\n        this.$container.trigger('start');\\n        this.canvasWidth = this.$canvas.width();\\n        this.canvasHeight = this.$canvas.height();\\n        this.floorDeltaY = this.canvasHeight / 11;\\n        this.floorWidth = this.canvasWidth / 5;\\n        this.floorHeight = this.floorWidth / 9;\\n        this.peopleHeight = parseInt(this.$people.css('height'));\\n        this.peopleWidth = parseInt(this.$people.css('width'));\\n\\n        this._currentPeopleVertical = this.canvasWidth / 2 + this.peopleWidth / 2;\\n        this.backup();\\n        //初始化台阶\\n        while (floorLoop++ < 13) {\\n            this.createFloorSpan();\\n        }\\n        //初始化任务控制\\n        this.peopleUserController();\\n        //首次更新人物视图\\n        this.peopleUpdateView();\\n        //首次更新人物血量\\n        this.updateBlood();\\n        //首次更新楼层数\\n        this.updateScore();\\n        //以每秒60帧执行游戏动画\\n        this.run(this.fps);\\n    }\\n\\n}\\nexport default GameController;\"]}","code":"webpackHotUpdate(0,{10:function(t,e,o){\"use strict\";Object.defineProperty(e,\"__esModule\",{value:!0}),o(9),window.requestAnimationFrame=window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||function(t){t()};var r=function(){this.floorRate=[{name:\"normal\",rate:15},{name:\"spring\",rate:15},{name:\"weak\",rate:15},{name:\"scroller-left\",rate:10},{name:\"scroller-right\",rate:10},{name:\"nail\",rate:35}],this.fps=60,this.speed=50,this.maxSpeed=350,this.gravity=1e3,this.peopleVerticalSpeed=200,this.animation=null,this.canvasWidth=0,this.canvasHeight=0,this.floorWidth=0,this.floorHeight=0,this.floorDeltaY=50,this.floorScore=1,this.blood=12,this.$container=$(\".container\"),this.$canvas=$(\".game-canvas\"),this.$scroller=$(\".scroller\"),this.$people=$(\".people\"),this.peopleRotateZ=0,this.peopleRotateDelta=25,this.peopleHeight=0,this.peopleWidth=0,this._t=0,this._currentScrollerY=0,this._currentPeopleY=20,this._currentPeopleVertical=0,this._floorScrollerY=200,this._maxJumpDistance=0,this._frameIndex=0,this._v0=0,this.checkFloorConfig()};r.prototype={constructor:r,Event:[\"gameover\",\"start\",\"rerun\",\"stop\",\"scoreupdate\"],on:function(t,e){-1!==this.Event.indexOf(t)&&this.$container.on(t,e)},gameover:function(){this.stop(),setTimeout(function(){$(\"#game-ct\").hide(),$(\".game-over\").show()}.bind(this),200)},checkFloorConfig:function(){for(var t=[0],e=0,o=this.floorRate,r=0;r<o.length;r++){var i=o[r].rate;if(\"number\"!=typeof i)throw new TypeError(\"rate type error\");e+=i,t.push(e)}if(100!==e)throw new RangeError(\"rate 加起来务必等于100!\");this._floorRateArray=t},getRandowFloor:function(t){for(var e=100*Math.random(),o=0;o<t.length-1;o++)if(e>=t[o]&&e<t[o+1])return this.floorRate[o]},createFloorSpan:function(){var t=this._floorScrollerY+=this.floorDeltaY,e=Math.random()*(this.canvasWidth-this.floorWidth),o='<i class=\"floor '+this.getRandowFloor(this._floorRateArray).name+'\"></i>';$(o).css({top:t,left:e,width:this.floorWidth,height:this.floorHeight}).appendTo(this.$scroller)},removeFloorSapn:function(){$(\".floor\").eq(0).remove(),this.floorScore++,this.updateScore()},updateBlood:function(){for(var t=$(\".blood i\"),e=0;e<t.length;e++)e<this.blood?t.eq(e).removeClass(\"lose\"):t.eq(e).addClass(\"lose\")},updateScore:function(){this.$container.trigger(\"scoreupdate\"),$(\".text-score\").text(this.floorScore)},loseBlood:function(){if(!this.__onFloor){if(this.blood-=0,this.$people.addClass(\"danger\"),setTimeout(function(){this.$people.removeClass(\"danger\")}.bind(this),1e3),$(\"#game-ct\").addClass(\"danger\"),setTimeout(function(){$(\"#game-ct\").removeClass(\"danger\")},100),this.blood<=0)return this.blood=0,this.updateBlood(),void this.gameover();this.updateBlood()}},addBlood:function(){this.__onFloor||this.blood>=12||(this.blood+=1,this.updateBlood())},floorNormal:function(){this.addBlood()},floorNail:function(){this.loseBlood()},floorWeak:function(t){this.addBlood(),setTimeout(function(){t.addClass(\"over\"),t[0].cross=!0},200)},floorScroll:function(t){this.addBlood(),this.__floorScrollDirection=t},floorScrollEnd:function(){this.__floorScrollDirection=null},floorSpring:function(){this.__$currentJumpFloor=$floorEle,this.jumpStart(),this.addBlood()},jumpStart:function(){this.__jumpMode=!0,this.__$currentJumpFloor.addClass(\"up\"),setTimeout(function(){this.__$currentJumpFloor.removeClass(\"up\")}.bind(this),200)},jumpEnd:function(t){this.__jumpMode&&(t&&(this.__$currentJumpFloor[0].cross=!0),this._currentJumpDistance=0,this.__jumpMode=!1)},people:function(t){var e=1/t,o=this._v0*e+this.gravity*e*e/2;this._t+=e,this._v0=this.gravity*this._t;var r=this.speed/t,i=this.peopleVerticalSpeed/t,s=$(\".floor\"),l=this.$people.offset();if(l.top>this.canvasHeight)this.gameover();else{for(var n=0;n<s.length;n++){var h=s.eq(n).offset(),a=Math.abs(l.top+this.peopleHeight-h.top);if(l.top<=o+r){this._t=0,this.__onFloor=!1,this.jumpEnd(!0),this.loseBlood();break}if(!this.__jumpMode&&!s.eq(n)[0].cross&&a<=o+r&&l.left>h.left-this.peopleWidth&&l.left<h.left+this.floorWidth){this._currentPeopleY=h.top-this.peopleHeight,s.eq(n).hasClass(\"normal\")&&this.floorNormal(),s.eq(n).hasClass(\"nail\")&&this.floorNail(),s.eq(n).hasClass(\"spring\")&&this.floorSpring(s.eq(n)),s.eq(n).hasClass(\"weak\")&&this.floorWeak(s.eq(n)),s.eq(n).hasClass(\"scroll-left\")&&this.floorScroll(\"left\"),s.eq(n).hasClass(\"scroll-right\")&&this.floorScroll(\"right\"),this._t=0,this.__onFloor=!0;break}n===s.length-1&&(this.__onFloor=!1)}this.__jumpMode&&(this._currentJumpDistance>=this._maxJumpDistance?this.jumpEnd():(this._currentJumpDistance+=o,this._currentPeopleY-=o+r)),this.__onFloor||this.__jumpMode||(this.floorScrollEnd(),this._currentPeopleY+=o);var p=i;this._peopleGoLeft&&(\"left\"===this.__floorScrollDirection&&(p*=1.5),\"right\"===this.__floorScrollDirection&&(p*=1.5),this._currentPeopleVertical>0&&(this._currentPeopleVertical-=p)),this._peopleGoRight&&(\"left\"===this.__floorScrollDirection&&(p*=.5),\"right\"===this.__floorScrollDirection&&(p*=.5),this._currentPeopleVertical<this.canvasWidth-this.peopleWidth&&(this._currentPeopleVertical+=p)),this._peopleGoRight||this._peopleGoLeft||(p*=.5,\"left\"===this.__floorScrollDirection&&this._currentPeopleVertical>0&&(this._currentPeopleVertical-=p),\"right\"===this.__floorScrollDirection&&this._currentPeopleVertical<this.canvasWidth-this.peopleWidth&&(this._currentPeopleVertical+=p)),this.peopleUpdateView()}},floorUpdateView:function(){Modernizr.csstransforms3d?this.$scroller.css({\"-webkit-transform\":\"transform3d(0,\"+this._currentScrollerY+\"px,0)\",\"-ms-transform\":\"transform3d(0,\"+this._currentScrollerY+\"px,0)\",transform:\"transform3d(0,\"+this._currentScrollerY+\"px,0)\"}):Modernizr.csstransforms?this.$scroller.css({\"-webkit-transform\":\"translateY(\"+this._currentScrollerY+\"px)\",\"-ms-transform\":\"translateY(\"+this._currentScrollerY+\"px)\",transform:\"translateY(\"+this._currentScrollerY+\"px)\"}):this.$scroller.css({top:this._currentScrollerY+\"px\"})},peopleUpdateView:function(){this.__onFloor&&(this._peopleGoLeft&&(this.peopleRotateZ-=this.peopleRotateDelta),this._peopleGoRight&&(this.peopleRotateZ+=this.peopleRotateDelta)),Modernizr.csstransforms3d?this.$people.css({\"-webkit-transform\":\"transform3d(\"+this._currentPeopleVertical+\"px,\"+this._currentPeopleY+\"px,0)\",\"-ms-transform\":\"transform3d(\"+this._currentPeopleVertical+\"px,\"+this._currentPeopleY+\"px,0)\",transform:\"transform3d(\"+this._currentPeopleVertical+\"px,\"+this._currentPeopleY+\"px,0)\"}):Modernizr.csstransforms?this.$people.css({\"-webkit-transform\":\"translate(\"+this._currentPeopleVertical+\"px,\"+this._currentPeopleY+\"px)\",\"-ms-transform\":\"translate(\"+this._currentPeopleVertical+\"px,\"+this._currentPeopleY+\"px)\",transform:\"translate(\"+this._currentPeopleVertical+\"px,\"+this._currentPeopleY+\"px)\"}):this.$people.css({left:this._currentPeopleVertical+\"px\",top:this._currentPeopleY+\"px\"})},peopleUserController:function(){var t=this;$(window).keydown(function(e){if(\"ArrowRight\"===e.key)return t._peopleGoRight=!0,void(t._peopleGoLeft=!1);\"ArrowLeft\"===e.key&&(t._peopleGoRight=!1,t._peopleGoLeft=!0)}).keyup(function(e){\"ArrowRight\"===e.key&&(t._peopleGoRight=!1,retrun),\"ArrowLeft\"!==e.key||(t._peopleGoLeft=!1)}),$(\".controller .left-ct\").on(\"touchstart\",function(e){t._peopleGoRight=!1,t._peopleGoLeft=!0}).on(\"tounchend\",function(e){t._peopleGoLeft=!1}),$(\".controller .right-ct\").on(\"touchstart\",function(e){t._peopleGoRight=!0,t._peopleGoLeft=!0}).on(\"touchend\",function(e){t._peopleGoRight=!1})},core:function(t){var e=this.speed/t,o=$(\".floor\");if(this._currentScrollerY-=e,this._currentScrollerY<=2*-this.canvasHeight){this._currentScrollerY+=this.canvasHeight,this._floorScrollerY-=this.canvasHeight;for(var r=0;r<o.length;r++)o.eq(r).css({top:parseInt($(\".floor\").eq(r).css(\"top\"))-this.canvasHeight})}this.floorUpdateView(),o.eq(0).offset().top<=-20&&(this.createFloorSpan(),this.removeFloorSapn()),this.people(t),this.speed<=this.maxSpeed&&(this.speed+=.1)},run:function(t){if(!this.animation){this._fps=t=t||60;var e=1e3/t,o=this;return this.animation=function r(){return setTimeout(function(){window.requestAnimationFrame(function(){o.core(t)}),o.animation=r()},e)}()}console.error(\"Animation has aready in process,please do not run again!\")},stop:function(){clearTimeout(this.animation),this.animation=void 0,this.$container.trigger(\"stop\")},reRun:function(){this.$container.trigger(\"rerun\"),$.extend(this,this.__paramBackup),$(\".floor\").remove(),this.start()},backup:function(){for(var t in this.__paramBackup={},this)\"number\"!=typeof this[t]&&\"string\"!=typeof this[t]||(this.__paramBackup[t]=this[t])},start:function(){var t=0;for(this.$container.trigger(\"start\"),this.canvasWidth=this.$canvas.width(),this.canvasHeight=this.$canvas.height(),this.floorDeltaY=this.canvasHeight/11,this.floorWidth=this.canvasWidth/5,this.floorHeight=this.floorWidth/9,this.peopleHeight=parseInt(this.$people.css(\"height\")),this.peopleWidth=parseInt(this.$people.css(\"width\")),this._currentPeopleVertical=this.canvasWidth/2+this.peopleWidth/2,this.backup();t++<13;)this.createFloorSpan();this.peopleUserController(),this.peopleUpdateView(),this.updateBlood(),this.updateScore(),this.run(this.fps)}},e.default=r}});","extractedComments":[]}